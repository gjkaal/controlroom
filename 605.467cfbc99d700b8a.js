"use strict";(self.webpackChunkechelon=self.webpackChunkechelon||[]).push([[605],{5605:(Yt,R,_)=>{_.r(R),_.d(R,{SiteModule:()=>Bt});var f=_(9808),a=_(3075),c=_(776),O=_(2601),t=_(5e3);let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[f.ez,c.KdK,a.u5,a.UX,c.IIj,c.nKr,c.zyh,c.T2N,c.uuI,O.r,c.rgH,c.LW9]]}),n})();var h=_(655),l=_(4987),N=_(567);let W=(()=>{class n{constructor(e){this.dialog=e,this.completed=new t.vpe,this.title="",this.text=""}cancel(){this.dialog.close()}confirm(){this.completed.emit(!0)}onCloseDialog(){this.cancel()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.X4l))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-confirm-popup"]],outputs:{completed:"completed"},decls:15,vars:2,consts:[[1,"spinner-wrapper"],[1,"delete_action"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",2)(4,"h4",3),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",4),t.NdJ("click",function(){return o.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"p"),t._uU(9),t.qZA()(),t.TgZ(10,"div",5)(11,"button",6),t.NdJ("click",function(){return o.cancel()}),t._uU(12,"No"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return o.confirm()}),t._uU(14,"Yes"),t.qZA()()()(),t.BQk()),2&e&&(t.xp6(5),t.Oqu(o.title),t.xp6(4),t.Oqu(o.text))},directives:[c.Asz,c.ndF,c.fMN,c.yKW,c.DPz],styles:[".delete_action[_ngcontent-%COMP%]{min-width:628px;width:628px}.delete_action[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{justify-content:center}.delete_action[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 20px 20px;min-width:140px}"]}),n})();var u=_(2192);function B(n,i){1&n&&(t.TgZ(0,"span",21),t._uU(1," This field is required "),t.qZA())}function Y(n,i){1&n&&(t.TgZ(0,"span",21),t._uU(1," This field is required "),t.qZA())}function Q(n,i){if(1&n&&(t.TgZ(0,"nb-option",22),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function E(n,i){if(1&n&&t._UZ(0,"nb-icon",23),2&n){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function G(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",24),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}const M=function(n){return{"table-icon":!0,disabled:n}};function $(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&n){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,M,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function L(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",26),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function j(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),s=r.$implicit,d=r.index;return t.oxw(2).onDelete(s.uuid,d)}),t.qZA()}}function P(n,i){if(1&n&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,B,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,Y,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"nb-select",12),t.YNc(9,Q,2,2,"nb-option",13),t.qZA()(),t.TgZ(10,"td"),t._UZ(11,"input",14),t.qZA(),t.TgZ(12,"td")(13,"div",15),t.YNc(14,E,1,1,"nb-icon",16),t.YNc(15,G,1,0,"nb-icon",17),t.YNc(16,$,1,3,"nb-icon",18),t.YNc(17,L,1,0,"nb-icon",19),t.YNc(18,j,1,0,"nb-icon",20),t.qZA()()()),2&n){const e=i.$implicit,o=i.index,r=t.oxw(2);let s,d;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("name"))?null:s.touched)&&(null==(s=r.getControl(o).get("name"))?null:s.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(d=r.getControl(o).get("nameShort"))?null:d.touched)&&(null==(d=r.getControl(o).get("nameShort"))?null:d.getError("required"))),t.xp6(3),t.Q6J("ngForOf",null==r.buffersTypes?null:r.buffersTypes.selectItems),t.xp6(2),t.s9C("value",e.workCenterBuffer?null==e.workCenterBuffer[0]?null:e.workCenterBuffer[0].capacity:0),t.xp6(3),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function H(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Buffer type"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Capacity"),t.qZA(),t.TgZ(11,"th",3)(12,"div",4)(13,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(14,"tbody",6),t.YNc(15,P,19,14,"tr",7),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(14),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.workcenters)}}let A=class{constructor(i,e,o,r,s,d,m,p){this.bufferTypeApi=i,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=s,this.formBuilder=d,this.dialog=m,this.toastrService=p,this.dataAvailable=!1,this.workstations=[],this.workcenters=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new a.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.workcenters].map(i=>{var e,o,r,s,d,m;return this.createWorkcenterGroup(!!i.uuid,null!==(e=i.name)&&void 0!==e?e:"",null!==(o=i.nameShort)&&void 0!==o?o:"",null!==(r=i.uuid)&&void 0!==r?r:"",i.workCenterBuffer?null===(d=null===(s=i.workCenterBuffer[0])||void 0===s?void 0:s.bufferType)||void 0===d?void 0:d.reference:"",i.workCenterBuffer?null===(m=i.workCenterBuffer[0])||void 0===m?void 0:m.capacity:0)}))})}createWorkcenterGroup(i=!0,e="",o="",r="",s="",d=0){return this.formBuilder.group({name:new a.NI({value:e,disabled:i},a.kI.required),nameShort:new a.NI({value:o,disabled:i},a.kI.required),uuid:new a.NI({value:r,disabled:i}),bufferType:new a.NI({value:s,disabled:i}),capacity:new a.NI({value:d,disabled:i})})}onAdd(){this.workcenters.push({name:"",nameShort:""}),this.buildForm(),this.cdr.markForCheck()}onRemove(i){this.workcenters.splice(i,1),this.form.get("formArrayName").removeAt(i),this.cdr.markForCheck()}onDelete(i,e){const o=this.dialog.open(W);o.componentRef.instance.title="Remove workcenter",o.componentRef.instance.text="Are you sure you want to remove this workcenter?",o.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(r=>{i?this.workcenterApi.dataWorkCenterDeleteUuidDelete(i).pipe((0,l.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(i){var e,o;const s=this.form.get("formArrayName").controls[i],m={bufferType:null===(o=null===(e=this.buffersTypes)||void 0===e?void 0:e.selectItems)||void 0===o?void 0:o.find(C=>C.reference===s.value.bufferType),capacity:s.value.capacity},p={name:s.value.name,nameShort:s.value.nameShort,workCenterBuffer:[m]},b=s.value.uuid;b?this.workcenterApi.dataWorkCenterUpdateUuidPut(b,p).pipe((0,l.t)(this)).subscribe({next:C=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.workcenterApi.dataWorkCenterCreatePost(p).pipe((0,l.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(i)}toggleEdit(i){const e=this.form.get("formArrayName");"DISABLED"===e.controls[i].status?e.controls[i].enable():e.controls[i].disable()}getControl(i){return this.form.get("formArrayName").controls[i]}cancelEdit(i){this.toggleEdit(i);const e=this.form.get("formArrayName"),o=this.workcenters.find(r=>r.uuid===e.controls[i].value.uuid);e.controls[i].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort})}formControlState(i){return this.form.get("formArrayName").controls[i].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,N.D)(this.workstationApi.dataWorkstationAllWorkstationsGet(),this.bufferTypeApi.dataBufferTypeAllBufferTypesGet(),this.workcenterApi.dataWorkCenterListGet()).pipe((0,l.t)(this)).subscribe({next:([i,e,o])=>{this.workcenters=o,this.workstations=i.selectItems,this.buffersTypes=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const i=[];return this.workcenters.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&i.push(e.name)}),i.length?`${i.join(", ")} workcenters has no workstation or buffer connection.`:""}getWarningInfo(i){const e=null==i?void 0:i.map(o=>o.displayValue).join(". ");return null!=e?e:""}showToast(i,e,o,r=1e5,s=""){!o||this.toastrService.show(e||"Success",o,{icon:s,position:i,status:e,duration:r,destroyByClick:!0,limit:1})}};A.\u0275fac=function(i){return new(i||A)(t.Y36(u.jg),t.Y36(u.F),t.Y36(u.Uv),t.Y36(u.B0),t.Y36(t.sBO),t.Y36(a.qu),t.Y36(c.Gln),t.Y36(c.quB))},A.\u0275cmp=t.Xpm({type:A,selectors:[["app-workcenter-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["fullWidth","","status","control","placeholder","Buffer type","formControlName","bufferType",1,"select","editable-input"],[3,"value",4,"ngFor","ngForOf"],["status","primary","nbInput","","type","number","formControlName","capacity",1,"editable-input",3,"value"],[1,"float-right","icons-wrapper"],["nbTooltipStatus","primary","class","warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],[3,"value"],["nbTooltipStatus","primary","icon","warning",1,"warning-icon",3,"nbTooltip"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(i,e){1&i&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,H,16,3,"table",1),t.qZA(),t.BQk()),2&i&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,f.O5,a.JL,a.sg,c.fMN,a.CE,f.sg,a.x0,c.h8i,a.Fj,a.JJ,a.u,c.rs,c.q51,a.wV,c.jNv,f.mk],styles:[""],changeDetection:0}),A=(0,h.gn)([(0,l.c)()],A);var q=_(6199);function V(n,i){if(1&n&&(t.TgZ(0,"nb-option",20),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function z(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"label",17),t._uU(2,"Workstations"),t.qZA(),t.TgZ(3,"div",12)(4,"nb-select",18),t.NdJ("selectedChange",function(r){return t.CHM(e),t.oxw(2).selectedWorkstationRef=r}),t.YNc(5,V,2,2,"nb-option",19),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("selected",e.selectedWorkstationRef),t.xp6(1),t.Q6J("ngForOf",e.workstationsList)}}function X(n,i){if(1&n&&(t.TgZ(0,"form",9)(1,"div",10)(2,"label",11),t._uU(3,"Name"),t.qZA(),t.TgZ(4,"div",12),t._UZ(5,"input",13),t.qZA()(),t.TgZ(6,"div",10)(7,"label",14),t._uU(8,"Name Short"),t.qZA(),t.TgZ(9,"div",12),t._UZ(10,"input",15),t.qZA()(),t.YNc(11,z,6,2,"div",16),t.qZA()),2&n){const e=t.oxw();t.Q6J("formGroup",e.addForm),t.xp6(11),t.Q6J("ngIf",e.workstationsList)}}function K(n,i){1&n&&(t.TgZ(0,"p"),t._uU(1,"Are you sure you want to remove this item?"),t.qZA())}let g=class{constructor(i,e,o,r){this.messageService=i,this.api=e,this.formBuilder=o,this.cdr=r,this.isSubmitted=!1,this.isCompleted=!1,this.dataAvailable=!1,this.label="",this.action="",this.commit="apply changes",this.completed=new t.vpe}ngOnInit(){this.initForm()}ngOnChanges(i){for(const e in i)"uuid"===e&&this.initForm()}getSelectedWorkcentersObjectsArray(){var i;return(null===(i=this.workstationsList)||void 0===i?void 0:i.filter(o=>this.selectedWorkstationRef.includes(o.reference)))||[]}getWorskstationsRefs(i){return i.map(e=>e.reference)}initForm(){this.addForm=this.formBuilder.group({name:["",a.kI.required],nameShort:["",a.kI.required]}),this.uuid&&""!==this.uuid?this.api.dataWorkCenterGetUuidGet(this.uuid).pipe((0,l.t)(this)).subscribe({next:i=>{var e,o;if(this.uuid=i.uuid,null===(e=this.addForm.get("name"))||void 0===e||e.setValue(i.name),null===(o=this.addForm.get("nameShort"))||void 0===o||o.setValue(i.nameShort),i.workstations){const r=this.getWorskstationsRefs(i.workstations);this.selectedWorkstationRef=r,this.selectedWorkstations=i.workstations}this.dataAvailable=!0,this.cdr.markForCheck()},error:()=>{this.messageService.notifyAboutChange(`Could not load: ${this.uuid}`),this.completed.emit(!1)}}):(this.dataAvailable=!0,this.uuid=void 0)}cancel(){this.messageService.notifyAboutChange("Operation cancelled."),this.completed.emit(!0)}submit(i){this.messageService.notifyAboutChange("Saving changes."),this.addOrUpdateRecord(i),this.completed.emit(!0)}addOrUpdateRecord(i){var e,o;const r={name:null===(e=this.addForm.get("name"))||void 0===e?void 0:e.value,nameShort:null===(o=this.addForm.get("nameShort"))||void 0===o?void 0:o.value,workstations:this.getSelectedWorkcentersObjectsArray()};console.log(`Action: ${i}`),this.isSubmitted=!0,"add"===i?this.api.dataWorkCenterCreatePost(r).pipe((0,l.t)(this)).subscribe({next:s=>{console.log(`result: ${s}`),s===u.Mx.Created?(this.messageService.notifyAboutChange(`Added: ${r.name}`),this.completed.emit(!0)):(this.messageService.notifyAboutChange(`Failed to add: ${r.name}, ${s}`),this.completed.emit(!1)),this.isCompleted=!0},error:()=>{console.log("Add failed"),this.messageService.notifyAboutChange(`Failed to add: ${r.name}`),this.isCompleted=!1,this.completed.emit(!1)}}):"update"===i?this.uuid?this.api.dataWorkCenterUpdateUuidPut(this.uuid,r).pipe((0,l.t)(this)).subscribe({next:()=>{this.messageService.notifyAboutChange(`Modified: ${r.name}`),this.isCompleted=!0},error:()=>{this.messageService.notifyAboutChange(`Falsed to modify: ${r.name}`),this.isCompleted=!1,this.completed.emit(!1)}}):(this.messageService.notifyAboutChange(`Failed to add: ${r.name}, invalid key`),this.isCompleted=!0,this.completed.emit(!1)):"delete"===i&&(this.uuid?this.api.dataWorkCenterDeleteUuidDelete(this.uuid).pipe((0,l.t)(this)).subscribe({next:()=>{this.messageService.notifyAboutChange(`Removed: ${r.name}`),this.isCompleted=!0,this.completed.emit(!0)},error:()=>{this.messageService.notifyAboutChange(`Failed to remove: ${r.name}`),this.isCompleted=!1,this.completed.emit(!1)}}):(this.messageService.notifyAboutChange(`Failed to remove: ${r.name}, invalid key`),this.isCompleted=!0,this.completed.emit(!1)))}onCloseDialog(){this.cancel()}};function tt(n,i){1&n&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function et(n,i){1&n&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function it(n,i){if(1&n&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function ot(n,i){if(1&n&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function nt(n,i){if(1&n&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function rt(n,i){if(1&n&&t._UZ(0,"nb-icon",26),2&n){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function st(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}g.\u0275fac=function(i){return new(i||g)(t.Y36(q.e),t.Y36(u.Uv),t.Y36(a.qu),t.Y36(t.sBO))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-workcenter-detail"]],inputs:{workstationsList:"workstationsList",uuid:"uuid"},outputs:{completed:"completed"},features:[t.TTD],decls:16,vars:7,consts:[[1,"spinner-wrapper",3,"nbSpinner"],[1,""],[1,"modal-title","text-center"],["icon","close",1,"close-dialog",3,"click"],[3,"formGroup",4,"ngIf","ngIfElse"],["deleteWarning",""],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"],[3,"formGroup"],[1,"row","mb-3"],["for","name",1,"col-sm-2"],[1,"col-sm-10"],["nbInput","","status","control","fullWidth","","id","name","formControlName","name"],["for","nameShort",1,"col-sm-2"],["nbInput","","status","control","fullWidth","","id","nameShort","formControlName","nameShort"],["class","row mb-3",4,"ngIf"],["for","workstations",1,"col-sm-2"],["multiple","","fullWidth","","status","control","placeholder","Workstations",1,"select",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,e){if(1&i&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card")(3,"nb-card-header",1)(4,"h4",2),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",3),t.NdJ("click",function(){return e.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body"),t.YNc(8,X,12,2,"form",4),t.YNc(9,K,2,0,"ng-template",null,5,t.W1O),t.qZA(),t.TgZ(11,"div",6)(12,"button",7),t.NdJ("click",function(){return e.cancel()}),t._uU(13,"Cancel"),t.qZA(),t.TgZ(14,"button",8),t.NdJ("click",function(){return e.submit(e.action)}),t._uU(15),t.qZA()()()(),t.BQk()),2&i){const o=t.MAs(10);t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable&&"delete"!==e.action),t.xp6(1),t.ekj("delete_action","delete"===e.action),t.xp6(3),t.Oqu(e.label),t.xp6(3),t.Q6J("ngIf","delete"!==e.action)("ngIfElse",o),t.xp6(7),t.hij(" ",e.commit," ")}},directives:[c.Q7R,c.Asz,c.ndF,c.fMN,c.yKW,f.O5,a._Y,a.JL,a.sg,c.h8i,a.Fj,a.JJ,a.u,c.rs,f.sg,c.q51,c.DPz],styles:["nb-card[_ngcontent-%COMP%]{min-width:650px}"],changeDetection:0}),g=(0,h.gn)([(0,l.c)()],g);const at=function(n){return{"table-icon":!0,disabled:n}};function ct(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",28),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&n){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,at,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function lt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",29),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function dt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",30),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),s=r.$implicit,d=r.index;return t.oxw(2).onDelete(s.uuid,d)}),t.qZA()}}function mt(n,i){if(1&n&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,tt,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,et,2,0,"span",10),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"input",12),t.qZA(),t.TgZ(9,"td")(10,"nb-select",13),t.YNc(11,it,2,2,"nb-option",14),t.qZA()(),t.TgZ(12,"td"),t._UZ(13,"input",15),t.qZA(),t.TgZ(14,"td")(15,"nb-select",16),t.YNc(16,ot,2,2,"nb-option",14),t.qZA()(),t.TgZ(17,"td")(18,"nb-select",17),t.YNc(19,nt,2,2,"nb-option",14),t.qZA()(),t.TgZ(20,"td")(21,"div",18),t.YNc(22,rt,1,1,"nb-icon",19),t.YNc(23,st,1,0,"nb-icon",20),t.YNc(24,ct,1,3,"nb-icon",21),t.YNc(25,lt,1,0,"nb-icon",22),t.YNc(26,dt,1,0,"nb-icon",23),t.qZA()()()),2&n){const e=i.$implicit,o=i.index,r=t.oxw(2);let s,d;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("name"))?null:s.touched)&&(null==(s=r.getControl(o).get("name"))?null:s.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(d=r.getControl(o).get("nameShort"))?null:d.touched)&&(null==(d=r.getControl(o).get("nameShort"))?null:d.getError("required"))),t.xp6(2),t.s9C("id",e.amountOfWorkstations),t.s9C("value",e.amountOfWorkstations),t.xp6(3),t.Q6J("ngForOf",null==r.buffersTypes?null:r.buffersTypes.selectItems),t.xp6(2),t.s9C("value",e.workStationBuffers?null==e.workStationBuffers[0]?null:e.workStationBuffers[0].capacity:0),t.xp6(3),t.Q6J("ngForOf",r.activities),t.xp6(3),t.Q6J("ngForOf",r.workcenters),t.xp6(3),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function ut(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Amount of workstations"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Buffer type"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"Capacity"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"Activity"),t.qZA(),t.TgZ(15,"th",3),t._uU(16,"Workcenter"),t.qZA(),t.TgZ(17,"th",3)(18,"div",4)(19,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(20,"tbody",6),t.YNc(21,mt,27,18,"tr",7),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(20),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.workstations)}}let y=class{constructor(i,e,o,r,s,d,m,p){this.bufferTypeApi=i,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=s,this.formBuilder=d,this.dialog=m,this.toastrService=p,this.dataAvailable=!1,this.workstations=[],this.workcenters=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new a.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.workstations].map(i=>{var e,o,r,s,d,m,p,b,C,F,D;return this.createWorkstationGroup(!!i.uuid,null!==(e=i.name)&&void 0!==e?e:"",null!==(o=i.nameShort)&&void 0!==o?o:"",null!==(r=i.amountOfWorkstations)&&void 0!==r?r:0,null!==(s=i.uuid)&&void 0!==s?s:"",null!==(m=null===(d=i.activity)||void 0===d?void 0:d.reference)&&void 0!==m?m:"",null!==(b=null===(p=i.workCenter)||void 0===p?void 0:p.reference)&&void 0!==b?b:"",i.workStationBuffers?null===(F=null===(C=i.workStationBuffers[0])||void 0===C?void 0:C.bufferType)||void 0===F?void 0:F.reference:"",i.workStationBuffers?null===(D=i.workStationBuffers[0])||void 0===D?void 0:D.capacity:0)}))})}createWorkstationGroup(i=!0,e="",o="",r=0,s="",d="",m="",p="",b=0){return this.formBuilder.group({name:new a.NI({value:e,disabled:i},a.kI.required),nameShort:new a.NI({value:o,disabled:i},a.kI.required),amountOfWorkstations:new a.NI({value:r,disabled:i}),uuid:new a.NI({value:s,disabled:i}),activity:new a.NI({value:d,disabled:i}),workcenter:new a.NI({value:m,disabled:i}),bufferType:new a.NI({value:p,disabled:i}),capacity:new a.NI({value:b,disabled:i})})}onAdd(){this.workstations.push({name:"",nameShort:"",amountOfWorkstations:0,activity:{},workCenter:{}}),this.buildForm(),this.cdr.markForCheck()}onRemove(i){this.workstations.splice(i,1),this.form.get("formArrayName").removeAt(i),this.cdr.markForCheck()}onDelete(i,e){const o=this.dialog.open(W);o.componentRef.instance.title="Remove workstation",o.componentRef.instance.text="Are you sure you want to remove this workstation?",o.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(r=>{i?this.workstationApi.dataWorkstationDeleteUuidDelete(i).pipe((0,l.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(i){var e,o;const s=this.form.get("formArrayName").controls[i],m={bufferType:null===(o=null===(e=this.buffersTypes)||void 0===e?void 0:e.selectItems)||void 0===o?void 0:o.find(C=>C.reference===s.value.bufferType),capacity:s.value.capacity},p={name:s.value.name,nameShort:s.value.nameShort,amountOfWorkstations:s.value.amountOfWorkstations,workStationBuffers:[m],activity:this.getSelectedActivityObject(s.value.activity),workCenter:this.getSelectedWorkcenterObject(s.value.workcenter)},b=s.value.uuid;b?this.workstationApi.dataWorkstationUpdateUuidPut(b,p).pipe((0,l.t)(this)).subscribe({next:C=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.workstationApi.dataWorkstationCreatePost(p).pipe((0,l.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(i)}toggleEdit(i){const e=this.form.get("formArrayName");"DISABLED"===e.controls[i].status?e.controls[i].enable():e.controls[i].disable()}getControl(i){return this.form.get("formArrayName").controls[i]}cancelEdit(i){this.toggleEdit(i);const e=this.form.get("formArrayName"),o=this.workstations.find(r=>r.uuid===e.controls[i].value.uuid);e.controls[i].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort,amountOfWorkstations:null==o?void 0:o.amountOfWorkstations})}formControlState(i){return this.form.get("formArrayName").controls[i].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,N.D)(this.workstationApi.dataWorkstationListGet(),this.bufferTypeApi.dataBufferTypeAllBufferTypesGet(),this.activityApi.dataActivityAllActivitiesGet(),this.workcenterApi.dataWorkCenterAllWorkCentersGet()).pipe((0,l.t)(this)).subscribe({next:([i,e,o,r])=>{this.workcenters=r.selectItems,this.workstations=i,this.activities=o.selectItems,this.buffersTypes=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const i=[];return this.workstations.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&i.push(e.name)}),i.length?`${i.join(", ")} workstations has no activity connection or workcenter connection or buffer connection.`:""}getWarningInfo(i){const e=null==i?void 0:i.map(o=>o.displayValue).join(". ");return null!=e?e:""}getSelectedActivityObject(i){var e;return(null===(e=this.activities)||void 0===e?void 0:e.filter(r=>r.reference===i)[0])||{}}getSelectedWorkcenterObject(i){var e;return(null===(e=this.workcenters)||void 0===e?void 0:e.filter(r=>r.reference===i)[0])||{}}showToast(i,e,o,r=1e5,s=""){!o||this.toastrService.show(e||"Success",o,{icon:s,position:i,status:e,duration:r,destroyByClick:!0,limit:1})}};function pt(n,i){if(1&n&&(t.TgZ(0,"nb-option",21),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function ft(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"label",18),t._uU(2,"Activity"),t.qZA(),t.TgZ(3,"div",12)(4,"nb-select",19),t.NdJ("selectedChange",function(r){return t.CHM(e),t.oxw(2).selectedActivityRef=r}),t.YNc(5,pt,2,2,"nb-option",20),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("selected",e.selectedActivityRef),t.xp6(1),t.Q6J("ngForOf",e.activitiesList)}}function _t(n,i){if(1&n&&(t.TgZ(0,"nb-option",21),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function ht(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"label",22),t._uU(2,"Workcenter"),t.qZA(),t.TgZ(3,"div",12)(4,"nb-select",23),t.NdJ("selectedChange",function(r){return t.CHM(e),t.oxw(2).selectedWorkcenterRef=r}),t.YNc(5,_t,2,2,"nb-option",20),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("selected",e.selectedWorkcenterRef),t.xp6(1),t.Q6J("ngForOf",e.workcentersList)}}function bt(n,i){if(1&n&&(t.TgZ(0,"form",9)(1,"div",10)(2,"label",11),t._uU(3,"Name"),t.qZA(),t.TgZ(4,"div",12),t._UZ(5,"input",13),t.qZA()(),t.TgZ(6,"div",10)(7,"label",14),t._uU(8,"Name Short"),t.qZA(),t.TgZ(9,"div",12),t._UZ(10,"input",15),t.qZA()(),t.TgZ(11,"div",10)(12,"label",14),t._uU(13,"Amount"),t.qZA(),t.TgZ(14,"div",12),t._UZ(15,"input",16),t.qZA()(),t.YNc(16,ft,6,2,"div",17),t.YNc(17,ht,6,2,"div",17),t.qZA()),2&n){const e=t.oxw();t.Q6J("formGroup",e.addForm),t.xp6(16),t.Q6J("ngIf",e.activitiesList),t.xp6(1),t.Q6J("ngIf",e.workcentersList)}}function gt(n,i){1&n&&(t.TgZ(0,"p"),t._uU(1,"Are you sure you want to remove this item?"),t.qZA())}y.\u0275fac=function(i){return new(i||y)(t.Y36(u.jg),t.Y36(u.F),t.Y36(u.Uv),t.Y36(u.B0),t.Y36(t.sBO),t.Y36(a.qu),t.Y36(c.Gln),t.Y36(c.quB))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-workstation-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["status","primary","nbInput","","type","number","formControlName","amountOfWorkstations",1,"editable-input",3,"id","value"],["fullWidth","","status","control","placeholder","Buffer type","formControlName","bufferType",1,"select","editable-input"],[3,"value",4,"ngFor","ngForOf"],["status","primary","nbInput","","type","number","formControlName","capacity",1,"editable-input",3,"value"],["fullWidth","","status","control","placeholder","Activity","formControlName","activity",1,"select","editable-input"],["fullWidth","","status","control","placeholder","Workcenter","formControlName","workcenter",1,"select","editable-input"],[1,"float-right","icons-wrapper"],["nbTooltipStatus","primary","class","warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],[3,"value"],["nbTooltipStatus","primary","icon","warning",1,"warning-icon",3,"nbTooltip"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(i,e){1&i&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,ut,22,3,"table",1),t.qZA(),t.BQk()),2&i&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,f.O5,a.JL,a.sg,c.fMN,a.CE,f.sg,a.x0,c.h8i,a.Fj,a.JJ,a.u,a.wV,c.rs,c.q51,c.jNv,f.mk],styles:[""],changeDetection:0}),y=(0,h.gn)([(0,l.c)()],y);let v=class{constructor(i,e,o,r){this.messageService=i,this.api=e,this.formBuilder=o,this.cdr=r,this.isSubmitted=!1,this.isCompleted=!1,this.dataAvailable=!1,this.label="",this.action="",this.commit="apply changes",this.completed=new t.vpe}ngOnInit(){this.initForm()}ngOnChanges(i){for(const e in i)"uuid"===e&&this.initForm()}initForm(){this.addForm=this.formBuilder.group({name:["",a.kI.required],nameShort:["",a.kI.required],amount:[0]}),this.uuid&&""!==this.uuid?this.api.dataWorkstationGetUuidGet(this.uuid).pipe((0,l.t)(this)).subscribe({next:i=>{var e,o,r,s,d;this.uuid=i.uuid,null===(e=this.addForm.get("name"))||void 0===e||e.setValue(i.name),null===(o=this.addForm.get("nameShort"))||void 0===o||o.setValue(i.nameShort),null===(r=this.addForm.get("amount"))||void 0===r||r.setValue(i.amountOfWorkstations),this.dataAvailable=!0;const m=null===(s=i.activity)||void 0===s?void 0:s.reference;m&&(this.selectedActivityRef=m,this.selectedActivity=this.getSelectedActivityObject());const p=null===(d=i.workCenter)||void 0===d?void 0:d.reference;p&&(this.selectedWorkcenterRef=p,this.selectedWorkcenter=this.getSelectedWorkcenterObject()),this.cdr.markForCheck()},error:()=>{this.messageService.notifyAboutChange(`Could not load: ${this.uuid}`),this.completed.emit(!1)}}):(this.dataAvailable=!0,this.uuid=void 0)}cancel(){this.messageService.notifyAboutChange("Operation cancelled."),this.completed.emit(!0)}submit(i){console.log(`Submit: ${i}`),this.messageService.notifyAboutChange("Saving changes."),this.addOrUpdateRecord(i),this.completed.emit(!0)}getSelectedActivityObject(){var i;return(null===(i=this.activitiesList)||void 0===i?void 0:i.filter(o=>o.reference===this.selectedActivityRef)[0])||{}}getSelectedWorkcenterObject(){var i;return(null===(i=this.workcentersList)||void 0===i?void 0:i.filter(o=>o.reference===this.selectedWorkcenterRef)[0])||{}}addOrUpdateRecord(i){var e,o,r;const s={name:null===(e=this.addForm.get("name"))||void 0===e?void 0:e.value,nameShort:null===(o=this.addForm.get("nameShort"))||void 0===o?void 0:o.value,amountOfWorkstations:null===(r=this.addForm.get("amount"))||void 0===r?void 0:r.value,workStationBuffers:[],activity:this.getSelectedActivityObject(),workCenter:this.getSelectedWorkcenterObject()};console.log(`Action: ${i}`),this.isSubmitted=!0,"add"===i?(console.log(`Post: ${JSON.stringify(s)}`),this.api.dataWorkstationCreatePost(s).pipe((0,l.t)(this)).subscribe({next:d=>{console.log(`Response: ${d}`),d===u.Mx.Created?(this.messageService.notifyAboutChange(`Added: ${s.name}`),this.completed.emit(!0)):(this.messageService.notifyAboutChange(`Failed to add: ${s.name}, ${d}`),this.completed.emit(!1)),this.isCompleted=!0},error:()=>{console.log("Error"),this.messageService.notifyAboutChange(`Failed to add: ${s.name}`),this.isCompleted=!1}})):"update"===i?this.uuid?this.api.dataWorkstationUpdateUuidPut(this.uuid,s).pipe((0,l.t)(this)).subscribe({next:()=>{this.messageService.notifyAboutChange(`Modified: ${s.name}`),this.isCompleted=!0},error:()=>{this.messageService.notifyAboutChange(`Falsed to modify: ${s.name}`),this.isCompleted=!1}}):(this.messageService.notifyAboutChange(`Failed to add: ${s.name}, invalid key`),this.completed.emit(!1)):"delete"===i&&(this.uuid?this.api.dataWorkstationDeleteUuidDelete(this.uuid).pipe((0,l.t)(this)).subscribe({next:()=>{this.messageService.notifyAboutChange(`Removed: ${s.name}`),this.isCompleted=!0},error:()=>{this.messageService.notifyAboutChange(`Falsed to remove: ${s.name}`),this.isCompleted=!1}}):(this.messageService.notifyAboutChange(`Failed to remove: ${s.name}, invalid key`),this.completed.emit(!1)))}onCloseDialog(){this.cancel()}};function vt(n,i){1&n&&(t.TgZ(0,"span",18),t._uU(1," This field is required "),t.qZA())}function kt(n,i){1&n&&(t.TgZ(0,"span",18),t._uU(1," This field is required "),t.qZA())}function Ct(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}v.\u0275fac=function(i){return new(i||v)(t.Y36(q.e),t.Y36(u.F),t.Y36(a.qu),t.Y36(t.sBO))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-workstation-detail"]],inputs:{workcentersList:"workcentersList",activitiesList:"activitiesList",uuid:"uuid"},outputs:{completed:"completed"},features:[t.TTD],decls:16,vars:7,consts:[[1,"spinner-wrapper",3,"nbSpinner"],[1,""],[1,"modal-title","text-center"],["icon","close",1,"close-dialog",3,"click"],[3,"formGroup",4,"ngIf","ngIfElse"],["deleteWarning",""],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"],[3,"formGroup"],[1,"row","mb-3"],["for","name",1,"col-sm-2"],[1,"col-sm-10"],["nbInput","","status","control","fullWidth","","id","name","formControlName","name"],["for","nameShort",1,"col-sm-2"],["nbInput","","status","control","fullWidth","","id","nameShort","formControlName","nameShort"],["nbInput","","status","control","fullWidth","","id","amount","formControlName","amount"],["class","row mb-3",4,"ngIf"],["for","activity",1,"col-sm-2"],["fullWidth","","status","control","placeholder","Activity",1,"select",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","workcenter",1,"col-sm-2"],["fullWidth","","status","control","placeholder","Workcenter",1,"select",3,"selected","selectedChange"]],template:function(i,e){if(1&i&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card")(3,"nb-card-header",1)(4,"h4",2),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",3),t.NdJ("click",function(){return e.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body"),t.YNc(8,bt,18,3,"form",4),t.YNc(9,gt,2,0,"ng-template",null,5,t.W1O),t.qZA(),t.TgZ(11,"div",6)(12,"button",7),t.NdJ("click",function(){return e.cancel()}),t._uU(13,"Cancel"),t.qZA(),t.TgZ(14,"button",8),t.NdJ("click",function(){return e.submit(e.action)}),t._uU(15),t.qZA()()()(),t.BQk()),2&i){const o=t.MAs(10);t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable&&"delete"!==e.action),t.xp6(1),t.ekj("delete_action","delete"===e.action),t.xp6(3),t.Oqu(e.label),t.xp6(3),t.Q6J("ngIf","delete"!==e.action)("ngIfElse",o),t.xp6(7),t.hij(" ",e.commit," ")}},directives:[c.Q7R,c.Asz,c.ndF,c.fMN,c.yKW,f.O5,a._Y,a.JL,a.sg,c.h8i,a.Fj,a.JJ,a.u,c.rs,f.sg,c.q51,c.DPz],styles:["nb-card[_ngcontent-%COMP%]{min-width:650px}"],changeDetection:0}),v=(0,h.gn)([(0,l.c)()],v);const At=function(n){return{"table-icon":!0,disabled:n}};function yt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&n){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,At,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function Tt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function wt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"nb-icon",22),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),s=r.$implicit,d=r.index;return t.oxw(2).onDelete(s.uuid,d)}),t.qZA()}}function Zt(n,i){if(1&n&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,vt,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,kt,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"textarea",12),t._uU(9,"            "),t.qZA()(),t.TgZ(10,"td")(11,"div",13),t.YNc(12,Ct,1,0,"nb-icon",14),t.YNc(13,yt,1,3,"nb-icon",15),t.YNc(14,Tt,1,0,"nb-icon",16),t.YNc(15,wt,1,0,"nb-icon",17),t.qZA()()()),2&n){const e=i.$implicit,o=i.index,r=t.oxw(2);let s,d;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("name"))?null:s.touched)&&(null==(s=r.getControl(o).get("name"))?null:s.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(d=r.getControl(o).get("nameShort"))?null:d.touched)&&(null==(d=r.getControl(o).get("nameShort"))?null:d.getError("required"))),t.xp6(2),t.s9C("id",e.description),t.s9C("value",e.description),t.xp6(4),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function xt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Description"),t.qZA(),t.TgZ(9,"th",3)(10,"div",4)(11,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(12,"tbody",6),t.YNc(13,Zt,16,13,"tr",7),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(12),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.activities)}}let T=class{constructor(i,e,o,r,s,d,m,p){this.bufferTypeApi=i,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=s,this.formBuilder=d,this.dialog=m,this.toastrService=p,this.dataAvailable=!1,this.workstations=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new a.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.activities].map(i=>{var e,o,r,s;return this.createActivityGroup(!!i.uuid,null!==(e=i.name)&&void 0!==e?e:"",null!==(o=i.nameShort)&&void 0!==o?o:"",null!==(r=i.description)&&void 0!==r?r:"",null!==(s=i.uuid)&&void 0!==s?s:"")}))})}createActivityGroup(i=!0,e="",o="",r="",s=""){return this.formBuilder.group({name:new a.NI({value:e,disabled:i},a.kI.required),nameShort:new a.NI({value:o,disabled:i},a.kI.required),description:new a.NI({value:r,disabled:i}),uuid:new a.NI({value:s,disabled:i})})}onAdd(){this.activities.push({name:"",nameShort:"",description:""}),this.buildForm(),this.cdr.markForCheck()}onRemove(i){this.activities.splice(i,1),this.form.get("formArrayName").removeAt(i),this.cdr.markForCheck()}onDelete(i,e){const o=this.dialog.open(W);o.componentRef.instance.title="Remove activity",o.componentRef.instance.text="Are you sure you want to remove this activity?",o.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(r=>{i?this.activityApi.dataActivityDeleteUuidDelete(i).pipe((0,l.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(i){const o=this.form.get("formArrayName").controls[i],r={name:o.value.name,nameShort:o.value.nameShort,description:o.value.description},s=o.value.uuid;s?this.activityApi.dataActivityUpdateUuidPut(s,r).pipe((0,l.t)(this)).subscribe({next:d=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.activityApi.dataActivityCreatePost(r).pipe((0,l.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(i)}toggleEdit(i){const e=this.form.get("formArrayName");"DISABLED"===e.controls[i].status?e.controls[i].enable():e.controls[i].disable()}getControl(i){return this.form.get("formArrayName").controls[i]}cancelEdit(i){this.toggleEdit(i);const e=this.form.get("formArrayName"),o=this.activities.find(r=>r.uuid===e.controls[i].value.uuid);e.controls[i].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort,description:null==o?void 0:o.description})}formControlState(i){return this.form.get("formArrayName").controls[i].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,N.D)(this.workstationApi.dataWorkstationAllWorkstationsGet(),this.activityApi.dataActivityListGet()).pipe((0,l.t)(this)).subscribe({next:([i,e])=>{this.workstations=i.selectItems,this.activities=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const i=[];return this.activities.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&i.push(e.name)}),i.length?`${i.join(", ")} activities has no workstation connection.`:""}getWarningInfo(i){const e=null==i?void 0:i.map(o=>o.displayValue).join(". ");return null!=e?e:""}showToast(i,e,o,r=1e5,s=""){!o||this.toastrService.show(e||"Success",o,{icon:s,position:i,status:e,duration:r,destroyByClick:!0,limit:1})}};function It(n,i){if(1&n&&(t.TgZ(0,"form",9)(1,"div",10)(2,"label",11),t._uU(3,"Name"),t.qZA(),t.TgZ(4,"div",12),t._UZ(5,"input",13),t.qZA()(),t.TgZ(6,"div",10)(7,"label",14),t._uU(8,"Name Short"),t.qZA(),t.TgZ(9,"div",12),t._UZ(10,"input",15),t.qZA()(),t.TgZ(11,"div",10)(12,"label",16),t._uU(13,"Description"),t.qZA(),t.TgZ(14,"div",12),t._UZ(15,"textarea",17),t.qZA()()()),2&n){const e=t.oxw();t.Q6J("formGroup",e.addForm)}}function St(n,i){1&n&&(t.TgZ(0,"p"),t._uU(1,"Are you sure you want to remove this item?"),t.qZA())}T.\u0275fac=function(i){return new(i||T)(t.Y36(u.jg),t.Y36(u.F),t.Y36(u.Uv),t.Y36(u.B0),t.Y36(t.sBO),t.Y36(a.qu),t.Y36(c.Gln),t.Y36(c.quB))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-activity-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["status","primary","nbInput","","type","text","formControlName","description",1,"editable-input",3,"id","value"],[1,"float-right","icons-wrapper"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(i,e){1&i&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,xt,14,3,"table",1),t.qZA(),t.BQk()),2&i&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,f.O5,a.JL,a.sg,c.fMN,a.CE,f.sg,a.x0,c.h8i,a.Fj,a.JJ,a.u,f.mk],styles:[""],changeDetection:0}),T=(0,h.gn)([(0,l.c)()],T);let k=class{constructor(i,e,o,r){this.messageService=i,this.api=e,this.formBuilder=o,this.cdr=r,this.isSubmitted=!1,this.isCompleted=!1,this.dataAvailable=!1,this.label="",this.action="",this.commit="apply changes",this.completed=new t.vpe}ngOnInit(){this.initForm()}ngOnChanges(i){for(const e in i)"uuid"===e&&this.initForm()}initForm(){this.addForm=this.formBuilder.group({name:["",a.kI.required],nameShort:["",a.kI.required],description:[""]}),this.uuid&&""!==this.uuid?this.api.dataActivityGetUuidGet(this.uuid).pipe((0,l.t)(this)).subscribe({next:i=>{var e,o,r;this.uuid=i.uuid,null===(e=this.addForm.get("name"))||void 0===e||e.setValue(i.name),null===(o=this.addForm.get("nameShort"))||void 0===o||o.setValue(i.nameShort),null===(r=this.addForm.get("description"))||void 0===r||r.setValue(i.description),this.dataAvailable=!0,this.cdr.markForCheck()},error:()=>{this.messageService.notifyAboutChange(`Could not load: ${this.uuid}`),this.completed.emit(!1)}}):(this.dataAvailable=!0,this.uuid=void 0)}cancel(){this.messageService.notifyAboutChange("Operation cancelled."),this.completed.emit(!0)}submit(i){this.messageService.notifyAboutChange("Saving changes."),this.addOrUpdateRecord(i),this.completed.emit(!0)}addOrUpdateRecord(i){var e,o,r;const s={name:null===(e=this.addForm.get("name"))||void 0===e?void 0:e.value,nameShort:null===(o=this.addForm.get("nameShort"))||void 0===o?void 0:o.value,description:null===(r=this.addForm.get("description"))||void 0===r?void 0:r.value};this.isSubmitted=!0,"add"===i?this.api.dataActivityCreatePost(s).pipe((0,l.t)(this)).subscribe({next:d=>{d===u.Mx.Created?(this.messageService.notifyAboutChange(`Added: ${s.name}`),this.completed.emit(!0)):(this.messageService.notifyAboutChange(`Failed to add: ${s.name}, ${d}`),this.completed.emit(!1)),this.isCompleted=!0},error:()=>{this.messageService.notifyAboutChange(`Failed to add: ${s.name}`),this.isCompleted=!1,this.completed.emit(!1)}}):"update"===i?this.uuid?this.api.dataActivityUpdateUuidPut(this.uuid,s).pipe((0,l.t)(this)).subscribe({next:()=>{this.messageService.notifyAboutChange(`Modified: ${s.name}`),this.isCompleted=!0,this.completed.emit(!0)},error:()=>{this.messageService.notifyAboutChange(`Falsed to modify: ${s.name}`),this.isCompleted=!1,this.completed.emit(!1)}}):(this.messageService.notifyAboutChange(`Failed to add: ${s.name}, invalid key`),this.isCompleted=!1,this.completed.emit(!1)):"delete"===i&&(this.uuid?this.api.dataActivityDeleteUuidDelete(this.uuid).pipe((0,l.t)(this)).subscribe({next:()=>{this.messageService.notifyAboutChange(`Removed: ${s.name}`),this.isCompleted=!0,this.completed.emit(!0)},error:()=>{this.messageService.notifyAboutChange(`Falsed to remove: ${s.name}`),this.isCompleted=!1,this.completed.emit(!1)}}):(this.messageService.notifyAboutChange(`Failed to remove: ${s.name}, invalid key`),this.isCompleted=!1,this.completed.emit(!1)))}onCloseDialog(){this.cancel()}};k.\u0275fac=function(i){return new(i||k)(t.Y36(q.e),t.Y36(u.B0),t.Y36(a.qu),t.Y36(t.sBO))},k.\u0275cmp=t.Xpm({type:k,selectors:[["app-activity-detail"]],inputs:{uuid:"uuid"},outputs:{completed:"completed"},features:[t.TTD],decls:16,vars:7,consts:[[1,"spinner-wrapper",3,"nbSpinner"],[1,""],[1,"modal-title","text-center"],["icon","close",1,"close-dialog",3,"click"],[3,"formGroup",4,"ngIf","ngIfElse"],["deleteWarning",""],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"],[3,"formGroup"],[1,"row","mb-3"],["for","name",1,"col-sm-2"],[1,"col-sm-10"],["nbInput","","status","control","fullWidth","","id","name","formControlName","name"],["for","nameShort",1,"col-sm-2"],["nbInput","","status","control","fullWidth","","id","nameShort","formControlName","nameShort"],["for","description",1,"col-sm-2"],["nbInput","","status","control","fullWidth","","id","description","formControlName","description"]],template:function(i,e){if(1&i&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card")(3,"nb-card-header",1)(4,"h4",2),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",3),t.NdJ("click",function(){return e.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body"),t.YNc(8,It,16,1,"form",4),t.YNc(9,St,2,0,"ng-template",null,5,t.W1O),t.qZA(),t.TgZ(11,"div",6)(12,"button",7),t.NdJ("click",function(){return e.cancel()}),t._uU(13,"Cancel"),t.qZA(),t.TgZ(14,"button",8),t.NdJ("click",function(){return e.submit(e.action)}),t._uU(15),t.qZA()()()(),t.BQk()),2&i){const o=t.MAs(10);t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable&&"delete"!==e.action),t.xp6(1),t.ekj("delete_action","delete"===e.action),t.xp6(3),t.Oqu(e.label),t.xp6(3),t.Q6J("ngIf","delete"!==e.action)("ngIfElse",o),t.xp6(7),t.hij(" ",e.commit," ")}},directives:[c.Q7R,c.Asz,c.ndF,c.fMN,c.yKW,f.O5,a._Y,a.JL,a.sg,c.h8i,a.Fj,a.JJ,a.u,c.DPz],styles:["nb-card[_ngcontent-%COMP%]{min-width:650px}"],changeDetection:0}),k=(0,h.gn)([(0,l.c)()],k);let w=class{};w.\u0275fac=function(i){return new(i||w)},w.\u0275cmp=t.Xpm({type:w,selectors:[["app-flow-table"]],decls:2,vars:0,template:function(i,e){1&i&&(t.TgZ(0,"p"),t._uU(1,"Flow table is not implkemented"),t.qZA())},styles:[""]}),w=(0,h.gn)([(0,l.c)()],w);var U=_(2268),Nt=_(9004),Wt=_(4515);let Z=class{constructor(i,e){this.dialog=i,this.cdr=e,this.reload="0"}create(i){const e=this.dialog.open(k);e.componentRef.instance.label="Add activity",e.componentRef.instance.action="add",e.componentRef.instance.commit="Add new",e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}update(i){const e=this.dialog.open(k);e.componentRef.instance.label="Edit activity",e.componentRef.instance.action="update",e.componentRef.instance.commit="Update",e.componentRef.instance.uuid=i,e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}delete(i){const e=this.dialog.open(k);e.componentRef.instance.label="Remove activity",e.componentRef.instance.action="delete",e.componentRef.instance.commit="Delete",e.componentRef.instance.uuid=i,e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}};Z.\u0275fac=function(i){return new(i||Z)(t.Y36(c.Gln),t.Y36(t.sBO))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["app-activities"]],decls:6,vars:1,consts:[[3,"reloadData","addNewItem","editItem","removeItem"]],template:function(i,e){1&i&&(t.TgZ(0,"h1"),t._uU(1,"Activities"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4," Define and describe activities. An activity can be linked to a workstation to help planning and have a better understanding of the work (the activity) that is execuited by the workforce on a specific workstation.\n"),t.qZA(),t.TgZ(5,"app-activity-table",0),t.NdJ("addNewItem",function(r){return e.create(r)})("editItem",function(r){return e.update(r)})("removeItem",function(r){return e.delete(r)}),t.qZA()),2&i&&(t.xp6(5),t.Q6J("reloadData",e.reload))},directives:[T],styles:[""],changeDetection:0}),Z=(0,h.gn)([(0,l.c)()],Z);let qt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-flows"]],decls:3,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"flows"),t.qZA(),t._UZ(2,"app-flow-table"))},directives:[w],styles:[""]}),n})();function Ft(n,i){if(1&n&&t._UZ(0,"nb-icon",14),2&n){const e=t.oxw().$implicit,o=t.oxw(3);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function Dt(n,i){if(1&n&&(t.TgZ(0,"div")(1,"div",6),t.YNc(2,Ft,1,1,"nb-icon",7),t.TgZ(3,"div",8),t._UZ(4,"img",9),t.qZA(),t.TgZ(5,"div",10)(6,"div",11)(7,"p",12),t._uU(8,"Workstation:"),t.qZA(),t.TgZ(9,"p",13),t._uU(10),t.qZA()(),t.TgZ(11,"div",11)(12,"p",12),t._uU(13,"Activity:"),t.qZA(),t.TgZ(14,"p",13),t._uU(15),t.qZA()(),t.TgZ(16,"div",11)(17,"p",12),t._uU(18,"Short:"),t.qZA(),t.TgZ(19,"p",13),t._uU(20),t.qZA()()()()()),2&n){const e=i.$implicit;t.xp6(2),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(8),t.Oqu(e.displayValue),t.xp6(5),t.Oqu(e.activity.displayValue),t.xp6(5),t.Oqu(e.code)}}function Rt(n,i){if(1&n&&(t.TgZ(0,"div",3)(1,"h2",3),t._uU(2),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,Dt,21,4,"div",5),t.qZA()()),2&n){const e=i.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.workstations)}}function Ot(n,i){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,Rt,5,2,"div",2),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.dataTree)}}let x=class{constructor(i,e,o){this.cdr=i,this.workcenterApi=e,this.workstationApi=o,this.workcenters=[],this.workstations=[],this.dataAvalaible=!1,this.dataTree=[]}ngOnInit(){this.getData()}getData(){(0,N.D)(this.workcenterApi.dataWorkCenterListGet(),this.workstationApi.dataWorkstationListGet()).pipe((0,l.t)(this)).subscribe({next:([i,e])=>{this.workcenters=i,this.workstations=e,this.dataAvalaible=!0,this.buildDataTree(),this.cdr.markForCheck()}})}buildDataTree(){const i=[...this.workcenters].map(e=>{var o;return null===(o=e.workstations)||void 0===o||o.forEach((r,s)=>{const d=r.reference,m=this.workstations.find(p=>p.uuid===d);e.workstations[s]=Object.assign(Object.assign({},e.workstations[s]),m)}),e});this.dataTree=i}getWarningInfo(i){return i.map(o=>o.displayValue).join(". ")}};x.\u0275fac=function(i){return new(i||x)(t.Y36(t.sBO),t.Y36(u.Uv),t.Y36(u.F))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-overview"]],decls:3,vars:2,consts:[[3,"nbSpinner"],[4,"ngIf"],["class","mb-3",4,"ngFor","ngForOf"],[1,"mb-3"],[1,"row"],[4,"ngFor","ngForOf"],[1,"item-card"],["nbTooltipStatus","primary","class","item-card__warning warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],[1,"item-card__image-wrapper"],["src","assets/images/packing.jpg","alt",""],[1,"item-card__content"],[1,"item-card__text"],[1,"item-card__label"],[1,"item-card__value"],["nbTooltipStatus","primary","icon","warning",1,"item-card__warning","warning-icon",3,"nbTooltip"]],template:function(i,e){1&i&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,Ot,2,1,"div",1),t.qZA(),t.BQk()),2&i&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvalaible),t.xp6(1),t.Q6J("ngIf",e.dataAvalaible))},directives:[c.Q7R,f.O5,f.sg,c.fMN,c.jNv],styles:[""]}),x=(0,h.gn)([(0,l.c)()],x);let I=class{constructor(i,e,o){this.dialog=i,this.cdr=e,this.workstationApi=o,this.reload="0",this.workstationsList=[]}ngOnInit(){this.fetchWorkstations()}create(i){const e=this.dialog.open(g);e.componentRef.instance.label="Add work center",e.componentRef.instance.action="add",e.componentRef.instance.commit="Add new",this.workstationsList&&(e.componentRef.instance.workstationsList=this.workstationsList),e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}update(i){const e=this.dialog.open(g);e.componentRef.instance.label="Edit work center",e.componentRef.instance.action="update",e.componentRef.instance.commit="Update",e.componentRef.instance.uuid=i,this.workstationsList&&(e.componentRef.instance.workstationsList=this.workstationsList),e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}delete(i){const e=this.dialog.open(g);e.componentRef.instance.label="Remove work center",e.componentRef.instance.action="delete",e.componentRef.instance.commit="Delete",e.componentRef.instance.uuid=i,e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}fetchWorkstations(){this.workstationApi.dataWorkstationAllWorkstationsGet().pipe((0,l.t)(this)).subscribe({next:i=>{(null==i?void 0:i.selectItems)&&(this.workstationsList=i.selectItems)}})}};I.\u0275fac=function(i){return new(i||I)(t.Y36(c.Gln),t.Y36(t.sBO),t.Y36(u.F))},I.\u0275cmp=t.Xpm({type:I,selectors:[["app-workcenters"]],decls:6,vars:1,consts:[[3,"reloadData","addNewItem","editItem","removeItem"]],template:function(i,e){1&i&&(t.TgZ(0,"h1"),t._uU(1,"Workcenters"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4," View and define your work centers here. A work center can contain zero or more workstations. These workstations can be linked to the work center in the details view.\n"),t.qZA(),t.TgZ(5,"app-workcenter-table",0),t.NdJ("addNewItem",function(r){return e.create(r)})("editItem",function(r){return e.update(r)})("removeItem",function(r){return e.delete(r)}),t.qZA()),2&i&&(t.xp6(5),t.Q6J("reloadData",e.reload))},directives:[A],styles:[""],changeDetection:0}),I=(0,h.gn)([(0,l.c)()],I);let S=class{constructor(i,e,o,r){this.dialog=i,this.cdr=e,this.activityApi=o,this.workcenterApi=r,this.reload="0",this.activitiesList=[],this.workcentersList=[]}ngOnInit(){this.fetchActivities(),this.fetchWorkcenters()}create(i){const e=this.dialog.open(v);e.componentRef.instance.label="Add work station",e.componentRef.instance.action="add",e.componentRef.instance.commit="Add new",this.activitiesList&&(e.componentRef.instance.activitiesList=this.activitiesList),this.workcentersList&&(e.componentRef.instance.workcentersList=this.workcentersList),e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}update(i){const e=this.dialog.open(v);e.componentRef.instance.label="Edit work station",e.componentRef.instance.action="update",e.componentRef.instance.commit="Update",e.componentRef.instance.uuid=i,this.activitiesList&&(e.componentRef.instance.activitiesList=this.activitiesList),this.workcentersList&&(e.componentRef.instance.workcentersList=this.workcentersList),e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}delete(i){const e=this.dialog.open(v);e.componentRef.instance.label="Remove work station",e.componentRef.instance.action="delete",e.componentRef.instance.commit="Delete",e.componentRef.instance.uuid=i,e.onBackdropClick.pipe((0,l.t)(this)).subscribe(()=>{e.close()}),e.componentRef.instance.completed.pipe((0,l.t)(this)).subscribe(o=>{e.close(),o&&(this.reload+=1,this.cdr.markForCheck())})}fetchActivities(){this.activityApi.dataActivityAllActivitiesGet().pipe((0,l.t)(this)).subscribe({next:i=>{(null==i?void 0:i.selectItems)&&(this.activitiesList=i.selectItems)}})}fetchWorkcenters(){this.workcenterApi.dataWorkCenterAllWorkCentersGet().pipe((0,l.t)(this)).subscribe({next:i=>{(null==i?void 0:i.selectItems)&&(this.workcentersList=i.selectItems)}})}};S.\u0275fac=function(i){return new(i||S)(t.Y36(c.Gln),t.Y36(t.sBO),t.Y36(u.B0),t.Y36(u.Uv))},S.\u0275cmp=t.Xpm({type:S,selectors:[["app-workstations"]],decls:6,vars:1,consts:[[3,"reloadData","addNewItem","editItem","removeItem"]],template:function(i,e){1&i&&(t.TgZ(0,"p"),t._uU(1,"Workstations"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4,"View and define your work stations here."),t.qZA(),t.TgZ(5,"app-workstation-table",0),t.NdJ("addNewItem",function(r){return e.create(r)})("editItem",function(r){return e.update(r)})("removeItem",function(r){return e.delete(r)}),t.qZA()),2&i&&(t.xp6(5),t.Q6J("reloadData",e.reload))},directives:[y],styles:[""],changeDetection:0}),S=(0,h.gn)([(0,l.c)()],S);const Ut=[{path:"overview",component:x},{path:"activity",component:Z},{path:"workcenter",component:I},{path:"workstation",component:S},{path:"flow",component:qt},{path:"",pathMatch:"full",redirectTo:"overview"},{path:"**",component:Nt.r}];let Jt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[U.Bz.forChild(Ut),Wt.n],U.Bz]}),n})(),Bt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[f.ez,a.u5,a.UX,Jt,c.T2N,c.zyh,c.KdK,c._WB,c.IIj,c.EoG,J,c.uuI,c.rgH,O.r,c.nKr]]}),n})()}}]);