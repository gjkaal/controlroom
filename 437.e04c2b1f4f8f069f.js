"use strict";(self.webpackChunkechelon=self.webpackChunkechelon||[]).push([[437],{9437:(Wt,I,f)=>{f.r(I),f.d(I,{SiteModule:()=>St});var d=f(9808),l=f(3075),c=f(776),N=f(2601),t=f(5e3);let q=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez]]}),i})(),O=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez]]}),i})(),F=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez,c.KdK,l.u5,l.UX,c.IIj,c.nKr,c.zyh,c.T2N,c.uuI,N.r,c.rgH,c.LW9,c.COg,q,O]]}),i})();var w=f(655),u=f(4987),A=f(567);let x=(()=>{class i{constructor(e){this.dialog=e,this.completed=new t.vpe,this.title="",this.text=""}cancel(){this.dialog.close()}confirm(){this.completed.emit(!0)}onCloseDialog(){this.cancel()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.X4l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-confirm-popup"]],outputs:{completed:"completed"},decls:15,vars:2,consts:[[1,"spinner-wrapper"],[1,"delete_action"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",2)(4,"h4",3),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",4),t.NdJ("click",function(){return o.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"p"),t._uU(9),t.qZA()(),t.TgZ(10,"div",5)(11,"button",6),t.NdJ("click",function(){return o.cancel()}),t._uU(12,"No"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return o.confirm()}),t._uU(14,"Yes"),t.qZA()()()(),t.BQk()),2&e&&(t.xp6(5),t.Oqu(o.title),t.xp6(4),t.Oqu(o.text))},directives:[c.Asz,c.ndF,c.fMN,c.yKW,c.DPz],styles:[".delete_action[_ngcontent-%COMP%]{min-width:628px;width:628px}.delete_action[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{justify-content:center}.delete_action[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 20px 20px;min-width:140px}"]}),i})();const S=function(i){return{"connectivity-popup__item":!0,active:i}};function J(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().onSelectItem(a)}),t._uU(1),t.qZA()}if(2&i){const e=n.$implicit,o=t.oxw();t.Q6J("ngClass",t.VKq(2,S,null==o.activeItems?null:o.activeItems.includes(e))),t.xp6(1),t.hij(" ",e.displayValue," ")}}function U(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().onSelectItem(a)}),t._uU(1),t.qZA()}if(2&i){const e=n.$implicit,o=t.oxw();t.Q6J("ngClass",t.VKq(2,S,null==o.activeItems?null:o.activeItems.includes(e))),t.xp6(1),t.hij(" ",e.displayValue," ")}}const W=function(i){return{"connectivity-popup__button":!0,disabled:i}};let B=(()=>{class i{constructor(e){this.dialog=e,this.completed=new t.vpe,this.title="",this.leftTitle="",this.rightTitle="",this.items=[],this.selectedItems=[],this.activeItems=[]}onSelectItem(e){var o,r;(null===(o=this.activeItems)||void 0===o?void 0:o.includes(e))?this.activeItems=this.activeItems.filter(a=>a!==e):null===(r=this.activeItems)||void 0===r||r.push(e)}onSelectItems(){var e,o;this.items=null===(e=this.items)||void 0===e?void 0:e.filter(r=>{var a;return!(null===(a=this.activeItems)||void 0===a?void 0:a.includes(r))}),null===(o=this.activeItems)||void 0===o||o.forEach(r=>{var a;return null===(a=this.selectedItems)||void 0===a?void 0:a.push(r)}),this.activeItems=[]}onDeselectItems(){var e,o;this.selectedItems=null===(e=this.selectedItems)||void 0===e?void 0:e.filter(r=>{var a;return!(null===(a=this.activeItems)||void 0===a?void 0:a.includes(r))}),null===(o=this.activeItems)||void 0===o||o.forEach(r=>{var a;return null===(a=this.items)||void 0===a?void 0:a.push(r)}),this.activeItems=[]}cancel(){this.dialog.close()}confirm(){this.completed.emit(this.selectedItems)}onCloseDialog(){this.cancel()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.X4l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-connectivity-popup"]],outputs:{completed:"completed"},decls:29,vars:11,consts:[[1,"connectivity-popup"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[1,"connectivity-popup__inner"],[1,"connectivity-popup__column"],[1,"connectivity-popup__item","connectivity-popup__item-title"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"connectivity-popup__buttons"],[3,"ngClass","click"],[1,"iconEcheclon","icon-arrow-right"],[1,"iconEcheclon","icon-arrow-left"],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",1)(4,"h4",2),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",3),t.NdJ("click",function(){return o.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"div",4)(9,"div",5)(10,"nb-list")(11,"nb-list-item",6),t._uU(12),t.qZA(),t.YNc(13,J,2,4,"nb-list-item",7),t.qZA()(),t.TgZ(14,"div",8)(15,"button",9),t.NdJ("click",function(){return o.onSelectItems()}),t._UZ(16,"i",10),t.qZA(),t.TgZ(17,"button",9),t.NdJ("click",function(){return o.onDeselectItems()}),t._UZ(18,"i",11),t.qZA()(),t.TgZ(19,"div",5)(20,"nb-list")(21,"nb-list-item",6),t._uU(22),t.qZA(),t.YNc(23,U,2,4,"nb-list-item",7),t.qZA()()()(),t.TgZ(24,"div",12)(25,"button",13),t.NdJ("click",function(){return o.cancel()}),t._uU(26,"Cancel"),t.qZA(),t.TgZ(27,"button",14),t.NdJ("click",function(){return o.confirm()}),t._uU(28,"Confirm"),t.qZA()()()(),t.BQk()),2&e&&(t.xp6(5),t.Oqu(o.title),t.xp6(7),t.hij(" ",o.leftTitle," "),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(2),t.Q6J("ngClass",t.VKq(7,W,!(null!=o.items&&o.items.length))),t.xp6(2),t.Q6J("ngClass",t.VKq(9,W,!(null!=o.selectedItems&&o.selectedItems.length))),t.xp6(5),t.hij(" ",o.rightTitle," "),t.xp6(1),t.Q6J("ngForOf",o.selectedItems))},directives:[c.Asz,c.ndF,c.fMN,c.yKW,c.zP_,c.qBV,d.sg,d.mk,c.DPz],styles:[".connectivity-popup[_ngcontent-%COMP%]{min-width:900px}.connectivity-popup[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:140px}.connectivity-popup__inner[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.connectivity-popup[_ngcontent-%COMP%]   nb-card[_ngcontent-%COMP%]{width:100%;position:relative}.connectivity-popup__column[_ngcontent-%COMP%]{width:40%;border:1px solid var(--color-primary-600)}.connectivity-popup__item[_ngcontent-%COMP%]{background-color:var(--color-primary-600);margin-bottom:5px;cursor:pointer}.connectivity-popup__item.active[_ngcontent-%COMP%]{background-color:var(--color-primary-800)}.connectivity-popup__item-title[_ngcontent-%COMP%]{background-color:var(--color-primary-500)}.connectivity-popup__buttons[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;justify-content:center;align-items:center}.connectivity-popup__button[_ngcontent-%COMP%]{width:30px;height:30px;font-size:15px;display:flex;justify-content:center;align-items:center;background:var(--color-primary-500);cursor:pointer;border:none;box-shadow:none;margin:5px 0}.connectivity-popup__button.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.connectivity-popup__button[_ngcontent-%COMP%]   .iconEcheclon[_ngcontent-%COMP%]{font-size:15px;height:auto;width:auto}"]}),i})();var h=f(2192);function D(i,n){1&i&&(t.TgZ(0,"span",22),t._uU(1," This field is required "),t.qZA())}function Q(i,n){1&i&&(t.TgZ(0,"span",22),t._uU(1," This field is required "),t.qZA())}function M(i,n){if(1&i&&(t.TgZ(0,"nb-option",23),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function Y(i,n){if(1&i&&t._UZ(0,"nb-icon",24),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function P(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}const R=function(i){return{"table-icon":!0,disabled:i}};function H(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",26),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&i){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,R,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function G(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function j(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",28),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),a=r.$implicit,s=r.index;return t.oxw(2).onDelete(a.uuid,s)}),t.qZA()}}function z(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,D,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,Q,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"nb-select",12),t.YNc(9,M,2,2,"nb-option",13),t.qZA()(),t.TgZ(10,"td"),t._UZ(11,"input",14),t.qZA(),t.TgZ(12,"td")(13,"i",15),t.NdJ("click",function(){const r=t.CHM(e),a=r.$implicit,s=r.index;return t.oxw(2).onOpenConnectionPopup(a,s)}),t.qZA()(),t.TgZ(14,"td")(15,"div",16),t.YNc(16,Y,1,1,"nb-icon",17),t.YNc(17,P,1,0,"nb-icon",18),t.YNc(18,H,1,3,"nb-icon",19),t.YNc(19,G,1,0,"nb-icon",20),t.YNc(20,j,1,0,"nb-icon",21),t.qZA()()()}if(2&i){const e=n.$implicit,o=n.index,r=t.oxw(2);let a,s;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(a=r.getControl(o).get("name"))?null:a.touched)&&(null==(a=r.getControl(o).get("name"))?null:a.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("nameShort"))?null:s.touched)&&(null==(s=r.getControl(o).get("nameShort"))?null:s.getError("required"))),t.xp6(3),t.Q6J("ngForOf",null==r.buffersTypes?null:r.buffersTypes.selectItems),t.xp6(2),t.s9C("value",e.workCenterBuffer?null==e.workCenterBuffer[0]?null:e.workCenterBuffer[0].capacity:0),t.xp6(5),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function V(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Buffer type"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Capacity"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"Connections"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"Actions"),t.qZA(),t.TgZ(15,"th",3)(16,"div",4)(17,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(18,"tbody",6),t.YNc(19,z,21,14,"tr",7),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(18),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.workcenters)}}let b=class{constructor(n,e,o,r,a,s,p,m){this.bufferTypeApi=n,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=a,this.formBuilder=s,this.dialog=p,this.toastrService=m,this.dataAvailable=!1,this.workstations=[],this.workcenters=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new l.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.workcenters].map(n=>{var e,o,r,a,s,p;return this.createWorkcenterGroup(!!n.uuid,null!==(e=n.name)&&void 0!==e?e:"",null!==(o=n.nameShort)&&void 0!==o?o:"",null!==(r=n.uuid)&&void 0!==r?r:"",n.workCenterBuffer?null===(s=null===(a=n.workCenterBuffer[0])||void 0===a?void 0:a.bufferType)||void 0===s?void 0:s.reference:"",n.workCenterBuffer?null===(p=n.workCenterBuffer[0])||void 0===p?void 0:p.capacity:0)}))})}createWorkcenterGroup(n=!0,e="",o="",r="",a="",s=0){return this.formBuilder.group({name:new l.NI({value:e,disabled:n},l.kI.required),nameShort:new l.NI({value:o,disabled:n},l.kI.required),uuid:new l.NI({value:r,disabled:n}),bufferType:new l.NI({value:a,disabled:n}),capacity:new l.NI({value:s,disabled:n})})}onAdd(){this.workcenters.push({name:"",nameShort:""}),this.buildForm(),this.cdr.markForCheck()}onRemove(n){this.workcenters.splice(n,1),this.form.get("formArrayName").removeAt(n),this.cdr.markForCheck()}onOpenConnectionPopup(n,e){var o,r,a;const s=this.dialog.open(B);s.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{s.close()});const p=this.workcenters[e];if(!(null===(o=this.workstations)||void 0===o?void 0:o.length)||!p)return;const m=(null===(r=null==p?void 0:p.workstations)||void 0===r?void 0:r.length)?this.workstations.filter(_=>{var g;return!(null===(g=null==p?void 0:p.workstations)||void 0===g?void 0:g.find(v=>v.reference===_.reference))}):[...this.workstations];s.componentRef.instance.items=m,s.componentRef.instance.selectedItems=null!==(a=null==p?void 0:p.workstations)&&void 0!==a?a:[],s.componentRef.instance.leftTitle="Workstations",s.componentRef.instance.rightTitle=`Workcenter: ${n.name}`,s.componentRef.instance.title="Connect a Workstation to the Workcenter",s.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(_=>{p.workstations=_,s.close(),this.saveEdit(e)})}onDelete(n,e){const o=this.dialog.open(x);o.componentRef.instance.title="Remove workcenter",o.componentRef.instance.text="Are you sure you want to remove this workcenter?",o.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(r=>{n?this.workcenterApi.dataWorkCenterDeleteUuidDelete(n).pipe((0,u.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(n){var e,o;const a=this.form.get("formArrayName").controls[n],p={bufferType:null===(o=null===(e=this.buffersTypes)||void 0===e?void 0:e.selectItems)||void 0===o?void 0:o.find(v=>v.reference===a.value.bufferType),capacity:a.value.capacity},_={name:a.value.name,nameShort:a.value.nameShort,workCenterBuffer:[p],workstations:this.workcenters[n].workstations},g=a.value.uuid;g?this.workcenterApi.dataWorkCenterUpdateUuidPut(g,_).pipe((0,u.t)(this)).subscribe({next:v=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.workcenterApi.dataWorkCenterCreatePost(_).pipe((0,u.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(n)}toggleEdit(n){const e=this.form.get("formArrayName");"DISABLED"===e.controls[n].status?e.controls[n].enable():e.controls[n].disable()}getControl(n){return this.form.get("formArrayName").controls[n]}cancelEdit(n){this.toggleEdit(n);const e=this.form.get("formArrayName"),o=this.workcenters.find(r=>r.uuid===e.controls[n].value.uuid);e.controls[n].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort})}formControlState(n){return this.form.get("formArrayName").controls[n].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,A.D)(this.workstationApi.dataWorkstationAllWorkstationsGet(),this.bufferTypeApi.dataBufferTypeAllBufferTypesGet(),this.workcenterApi.dataWorkCenterListGet()).pipe((0,u.t)(this)).subscribe({next:([n,e,o])=>{this.workcenters=o,this.workstations=n.selectItems,this.buffersTypes=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const n=[];return this.workcenters.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&n.push(e.name)}),n.length?`${n.join(", ")} workcenters has no workstation or buffer connection.`:""}getWarningInfo(n){const e=null==n?void 0:n.map(o=>o.displayValue).join(". ");return null!=e?e:""}showToast(n,e,o,r=5e3,a=""){!o||this.toastrService.show(e||"Success",o,{icon:a,position:n,status:e,duration:r,destroyByClick:!0,limit:1})}};function $(i,n){1&i&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function K(i,n){1&i&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function X(i,n){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function L(i,n){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function tt(i,n){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function et(i,n){if(1&i&&t._UZ(0,"nb-icon",26),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function nt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}b.\u0275fac=function(n){return new(n||b)(t.Y36(h.jg),t.Y36(h.F),t.Y36(h.Uv),t.Y36(h.B0),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(c.Gln),t.Y36(c.quB))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-workcenter-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["fullWidth","","status","control","placeholder","Buffer type","formControlName","bufferType",1,"select","editable-input"],[3,"value",4,"ngFor","ngForOf"],["status","primary","nbInput","","type","number","formControlName","capacity",1,"editable-input",3,"value"],[1,"iconEcheclon","icon-connection",3,"click"],[1,"float-right","icons-wrapper"],["nbTooltipStatus","primary","class","warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],[3,"value"],["nbTooltipStatus","primary","icon","warning",1,"warning-icon",3,"nbTooltip"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,V,20,3,"table",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,d.O5,l.JL,l.sg,c.fMN,l.CE,d.sg,l.x0,c.h8i,l.Fj,l.JJ,l.u,c.rs,c.q51,l.wV,c.jNv,d.mk],styles:[""],changeDetection:0}),b=(0,w.gn)([(0,u.c)()],b);const ot=function(i){return{"table-icon":!0,disabled:i}};function it(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",28),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&i){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,ot,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function rt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",29),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function at(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",30),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),a=r.$implicit,s=r.index;return t.oxw(2).onDelete(a.uuid,s)}),t.qZA()}}function ct(i,n){if(1&i&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,$,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,K,2,0,"span",10),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"input",12),t.qZA(),t.TgZ(9,"td")(10,"nb-select",13),t.YNc(11,X,2,2,"nb-option",14),t.qZA()(),t.TgZ(12,"td"),t._UZ(13,"input",15),t.qZA(),t.TgZ(14,"td")(15,"nb-select",16),t.YNc(16,L,2,2,"nb-option",14),t.qZA()(),t.TgZ(17,"td")(18,"nb-select",17),t.YNc(19,tt,2,2,"nb-option",14),t.qZA()(),t.TgZ(20,"td")(21,"div",18),t.YNc(22,et,1,1,"nb-icon",19),t.YNc(23,nt,1,0,"nb-icon",20),t.YNc(24,it,1,3,"nb-icon",21),t.YNc(25,rt,1,0,"nb-icon",22),t.YNc(26,at,1,0,"nb-icon",23),t.qZA()()()),2&i){const e=n.$implicit,o=n.index,r=t.oxw(2);let a,s;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(a=r.getControl(o).get("name"))?null:a.touched)&&(null==(a=r.getControl(o).get("name"))?null:a.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("nameShort"))?null:s.touched)&&(null==(s=r.getControl(o).get("nameShort"))?null:s.getError("required"))),t.xp6(2),t.s9C("id",e.amountOfWorkstations),t.s9C("value",e.amountOfWorkstations),t.xp6(3),t.Q6J("ngForOf",null==r.buffersTypes?null:r.buffersTypes.selectItems),t.xp6(2),t.s9C("value",e.workStationBuffers?null==e.workStationBuffers[0]?null:e.workStationBuffers[0].capacity:0),t.xp6(3),t.Q6J("ngForOf",r.activities),t.xp6(3),t.Q6J("ngForOf",r.workcenters),t.xp6(3),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function st(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Amount of workstations"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Buffer type"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"Capacity"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"Activity"),t.qZA(),t.TgZ(15,"th",3),t._uU(16,"Workcenter"),t.qZA(),t.TgZ(17,"th",3)(18,"div",4)(19,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(20,"tbody",6),t.YNc(21,ct,27,18,"tr",7),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(20),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.workstations)}}let T=class{constructor(n,e,o,r,a,s,p,m){this.bufferTypeApi=n,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=a,this.formBuilder=s,this.dialog=p,this.toastrService=m,this.dataAvailable=!1,this.workstations=[],this.workcenters=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new l.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.workstations].map(n=>{var e,o,r,a,s,p,m,_,g,v,Z;return this.createWorkstationGroup(!!n.uuid,null!==(e=n.name)&&void 0!==e?e:"",null!==(o=n.nameShort)&&void 0!==o?o:"",null!==(r=n.amountOfWorkstations)&&void 0!==r?r:0,null!==(a=n.uuid)&&void 0!==a?a:"",null!==(p=null===(s=n.activity)||void 0===s?void 0:s.reference)&&void 0!==p?p:"",null!==(_=null===(m=n.workCenter)||void 0===m?void 0:m.reference)&&void 0!==_?_:"",n.workStationBuffers?null===(v=null===(g=n.workStationBuffers[0])||void 0===g?void 0:g.bufferType)||void 0===v?void 0:v.reference:"",n.workStationBuffers?null===(Z=n.workStationBuffers[0])||void 0===Z?void 0:Z.capacity:0)}))})}createWorkstationGroup(n=!0,e="",o="",r=0,a="",s="",p="",m="",_=0){return this.formBuilder.group({name:new l.NI({value:e,disabled:n},l.kI.required),nameShort:new l.NI({value:o,disabled:n},l.kI.required),amountOfWorkstations:new l.NI({value:r,disabled:n}),uuid:new l.NI({value:a,disabled:n}),activity:new l.NI({value:s,disabled:n}),workcenter:new l.NI({value:p,disabled:n}),bufferType:new l.NI({value:m,disabled:n}),capacity:new l.NI({value:_,disabled:n})})}onAdd(){this.workstations.push({name:"",nameShort:"",amountOfWorkstations:0,activity:{},workCenter:{}}),this.buildForm(),this.cdr.markForCheck()}onRemove(n){this.workstations.splice(n,1),this.form.get("formArrayName").removeAt(n),this.cdr.markForCheck()}onDelete(n,e){const o=this.dialog.open(x);o.componentRef.instance.title="Remove workstation",o.componentRef.instance.text="Are you sure you want to remove this workstation?",o.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(r=>{n?this.workstationApi.dataWorkstationDeleteUuidDelete(n).pipe((0,u.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(n){var e,o;const a=this.form.get("formArrayName").controls[n],p={bufferType:null===(o=null===(e=this.buffersTypes)||void 0===e?void 0:e.selectItems)||void 0===o?void 0:o.find(g=>g.reference===a.value.bufferType),capacity:a.value.capacity},m={name:a.value.name,nameShort:a.value.nameShort,amountOfWorkstations:a.value.amountOfWorkstations,workStationBuffers:[p],activity:this.getSelectedActivityObject(a.value.activity),workCenter:this.getSelectedWorkcenterObject(a.value.workcenter)},_=a.value.uuid;_?this.workstationApi.dataWorkstationUpdateUuidPut(_,m).pipe((0,u.t)(this)).subscribe({next:g=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.workstationApi.dataWorkstationCreatePost(m).pipe((0,u.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(n)}toggleEdit(n){const e=this.form.get("formArrayName");"DISABLED"===e.controls[n].status?e.controls[n].enable():e.controls[n].disable()}getControl(n){return this.form.get("formArrayName").controls[n]}cancelEdit(n){this.toggleEdit(n);const e=this.form.get("formArrayName"),o=this.workstations.find(r=>r.uuid===e.controls[n].value.uuid);e.controls[n].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort,amountOfWorkstations:null==o?void 0:o.amountOfWorkstations})}formControlState(n){return this.form.get("formArrayName").controls[n].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,A.D)(this.workstationApi.dataWorkstationListGet(),this.bufferTypeApi.dataBufferTypeAllBufferTypesGet(),this.activityApi.dataActivityAllActivitiesGet(),this.workcenterApi.dataWorkCenterAllWorkCentersGet()).pipe((0,u.t)(this)).subscribe({next:([n,e,o,r])=>{this.workcenters=r.selectItems,this.workstations=n,this.activities=o.selectItems,this.buffersTypes=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const n=[];return this.workstations.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&n.push(e.name)}),n.length?`${n.join(", ")} workstations has no activity connection or workcenter connection or buffer connection.`:""}getWarningInfo(n){const e=null==n?void 0:n.map(o=>o.displayValue).join(". ");return null!=e?e:""}getSelectedActivityObject(n){var e;return(null===(e=this.activities)||void 0===e?void 0:e.filter(r=>r.reference===n)[0])||{}}getSelectedWorkcenterObject(n){var e;return(null===(e=this.workcenters)||void 0===e?void 0:e.filter(r=>r.reference===n)[0])||{}}showToast(n,e,o,r=5e3,a=""){!o||this.toastrService.show(e||"Success",o,{icon:a,position:n,status:e,duration:r,destroyByClick:!0,limit:1})}};T.\u0275fac=function(n){return new(n||T)(t.Y36(h.jg),t.Y36(h.F),t.Y36(h.Uv),t.Y36(h.B0),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(c.Gln),t.Y36(c.quB))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-workstation-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["status","primary","nbInput","","type","number","formControlName","amountOfWorkstations",1,"editable-input",3,"id","value"],["fullWidth","","status","control","placeholder","Buffer type","formControlName","bufferType",1,"select","editable-input"],[3,"value",4,"ngFor","ngForOf"],["status","primary","nbInput","","type","number","formControlName","capacity",1,"editable-input",3,"value"],["fullWidth","","status","control","placeholder","Activity","formControlName","activity",1,"select","editable-input"],["fullWidth","","status","control","placeholder","Workcenter","formControlName","workcenter",1,"select","editable-input"],[1,"float-right","icons-wrapper"],["nbTooltipStatus","primary","class","warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],[3,"value"],["nbTooltipStatus","primary","icon","warning",1,"warning-icon",3,"nbTooltip"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,st,22,3,"table",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,d.O5,l.JL,l.sg,c.fMN,l.CE,d.sg,l.x0,c.h8i,l.Fj,l.JJ,l.u,l.wV,c.rs,c.q51,c.jNv,d.mk],styles:[""],changeDetection:0}),T=(0,w.gn)([(0,u.c)()],T);let lt=(()=>{class i{constructor(e){this.elementRef=e}onInput(){this.resize()}ngOnInit(){this.elementRef.nativeElement.scrollHeight&&setTimeout(()=>this.resize())}resize(){this.elementRef.nativeElement.style.height="0",this.elementRef.nativeElement.style.height=`${this.elementRef.nativeElement.scrollHeight+5}px`}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275dir=t.lG2({type:i,selectors:[["","appTextareaAutoresize",""]],hostBindings:function(e,o){1&e&&t.NdJ("input",function(){return o.onInput()})}}),i})(),pt=(()=>{class i{constructor(e){this.elementRef=e,this.isExpanded=!1,this.wrappers=[]}onClick(e){this.isExpanded=!this.isExpanded,this.resize()}ngAfterViewInit(){this.wrappers=this.elementRef.nativeElement.parentElement.parentElement.querySelectorAll(".toggle-height-wrapper"),this.wrappers.forEach(e=>{e.style.maxHeight="47px"})}resize(){this.wrappers.forEach(this.isExpanded?e=>e.style.maxHeight="none":e=>e.style.maxHeight="47px")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq))},i.\u0275dir=t.lG2({type:i,selectors:[["","appToggleElementHeight",""]],hostBindings:function(e,o){1&e&&t.NdJ("click",function(a){return o.onClick(a)})}}),i})();function ut(i,n){1&i&&(t.TgZ(0,"span",21),t._uU(1," This field is required "),t.qZA())}function mt(i,n){1&i&&(t.TgZ(0,"span",21),t._uU(1," This field is required "),t.qZA())}function dt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",22),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}const _t=function(i){return{"table-icon":!0,disabled:i}};function ft(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",23),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&i){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,_t,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function ht(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",24),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function gt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),a=r.$implicit,s=r.index;return t.oxw(2).onDelete(a.uuid,s)}),t.qZA()}}function vt(i,n){1&i&&t._UZ(0,"i",26)}function bt(i,n){if(1&i&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,ut,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,mt,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"div",12)(9,"textarea",13),t._uU(10,"              "),t.qZA()()(),t.TgZ(11,"td")(12,"div",14),t.YNc(13,dt,1,0,"nb-icon",15),t.YNc(14,ft,1,3,"nb-icon",16),t.YNc(15,ht,1,0,"nb-icon",17),t.YNc(16,gt,1,0,"nb-icon",18),t.qZA()(),t.TgZ(17,"td",19),t.YNc(18,vt,1,0,"i",20),t.qZA()()),2&i){const e=n.$implicit,o=n.index,r=t.oxw(2);let a,s;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(a=r.getControl(o).get("name"))?null:a.touched)&&(null==(a=r.getControl(o).get("name"))?null:a.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("nameShort"))?null:s.touched)&&(null==(s=r.getControl(o).get("nameShort"))?null:s.getError("required"))),t.xp6(3),t.s9C("id",e.description),t.s9C("value",e.description),t.xp6(4),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(2),t.Q6J("ngIf",e.description&&e.description.length&&e.description.length>20)}}function Tt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Description"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Actions"),t.qZA(),t.TgZ(11,"th",3)(12,"div",4)(13,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(14,"tbody",6),t.YNc(15,bt,19,14,"tr",7),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(14),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.activities)}}let y=class{constructor(n,e,o,r,a,s,p,m){this.bufferTypeApi=n,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=a,this.formBuilder=s,this.dialog=p,this.toastrService=m,this.dataAvailable=!1,this.workstations=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new l.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.activities].map(n=>{var e,o,r,a;return this.createActivityGroup(!!n.uuid,null!==(e=n.name)&&void 0!==e?e:"",null!==(o=n.nameShort)&&void 0!==o?o:"",null!==(r=n.description)&&void 0!==r?r:"",null!==(a=n.uuid)&&void 0!==a?a:"")}))})}createActivityGroup(n=!0,e="",o="",r="",a=""){return this.formBuilder.group({name:new l.NI({value:e,disabled:n},l.kI.required),nameShort:new l.NI({value:o,disabled:n},l.kI.required),description:new l.NI({value:r,disabled:n}),uuid:new l.NI({value:a,disabled:n})})}onAdd(){this.activities.push({name:"",nameShort:"",description:""}),this.buildForm(),this.cdr.markForCheck()}onRemove(n){this.activities.splice(n,1),this.form.get("formArrayName").removeAt(n),this.cdr.markForCheck()}onDelete(n,e){const o=this.dialog.open(x);o.componentRef.instance.title="Remove activity",o.componentRef.instance.text="Are you sure you want to remove this activity?",o.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(r=>{n?this.activityApi.dataActivityDeleteUuidDelete(n).pipe((0,u.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(n){const o=this.form.get("formArrayName").controls[n],r={name:o.value.name,nameShort:o.value.nameShort,description:o.value.description},a=o.value.uuid;a?this.activityApi.dataActivityUpdateUuidPut(a,r).pipe((0,u.t)(this)).subscribe({next:s=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.activityApi.dataActivityCreatePost(r).pipe((0,u.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(n)}toggleEdit(n){const e=this.form.get("formArrayName");"DISABLED"===e.controls[n].status?e.controls[n].enable():e.controls[n].disable()}getControl(n){return this.form.get("formArrayName").controls[n]}cancelEdit(n){this.toggleEdit(n);const e=this.form.get("formArrayName"),o=this.activities.find(r=>r.uuid===e.controls[n].value.uuid);e.controls[n].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort,description:null==o?void 0:o.description})}formControlState(n){return this.form.get("formArrayName").controls[n].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,A.D)(this.workstationApi.dataWorkstationAllWorkstationsGet(),this.activityApi.dataActivityListGet()).pipe((0,u.t)(this)).subscribe({next:([n,e])=>{this.workstations=n.selectItems,this.activities=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const n=[];return this.activities.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&n.push(e.name)}),n.length?`${n.join(", ")} activities has no workstation connection.`:""}getWarningInfo(n){const e=null==n?void 0:n.map(o=>o.displayValue).join(". ");return null!=e?e:""}showToast(n,e,o,r=5e3,a=""){!o||this.toastrService.show(e||"Success",o,{icon:a,position:n,status:e,duration:r,destroyByClick:!0,limit:1})}};y.\u0275fac=function(n){return new(n||y)(t.Y36(h.jg),t.Y36(h.F),t.Y36(h.Uv),t.Y36(h.B0),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(c.Gln),t.Y36(c.quB))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-activity-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],[1,"overflow-hidden","toggle-height-wrapper"],["appTextareaAutoresize","","status","primary","nbInput","","type","text","formControlName","description",1,"editable-input",3,"id","value"],[1,"float-right","icons-wrapper"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-right"],["appToggleElementHeight","","class","iconEcheclon icon-arrow-down",4,"ngIf"],[1,"text-danger"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"],["appToggleElementHeight","",1,"iconEcheclon","icon-arrow-down"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,Tt,16,3,"table",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,d.O5,l.JL,l.sg,c.fMN,l.CE,d.sg,l.x0,c.h8i,l.Fj,l.JJ,l.u,lt,d.mk,pt],styles:[""],changeDetection:0}),y=(0,w.gn)([(0,u.c)()],y);let k=class{};k.\u0275fac=function(n){return new(n||k)},k.\u0275cmp=t.Xpm({type:k,selectors:[["app-flow-table"]],decls:2,vars:0,template:function(n,e){1&n&&(t.TgZ(0,"p"),t._uU(1,"Flow table is not implkemented"),t.qZA())},styles:[""]}),k=(0,w.gn)([(0,u.c)()],k);var E=f(2268),yt=f(9004),kt=f(4515);let Ct=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-activities"]],decls:6,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Activities"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4," Define and describe activities. An activity can be linked to a workstation to help planning and have a better understanding of the work (the activity) that is execuited by the workforce on a specific workstation.\n"),t.qZA(),t._UZ(5,"app-activity-table"))},directives:[y],styles:[""],changeDetection:0}),i})(),wt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flows"]],decls:3,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"flows"),t.qZA(),t._UZ(2,"app-flow-table"))},directives:[k],styles:[""]}),i})();function At(i,n){if(1&i&&t._UZ(0,"nb-icon",14),2&i){const e=t.oxw().$implicit,o=t.oxw(3);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function xt(i,n){if(1&i&&(t.TgZ(0,"div")(1,"div",6),t.YNc(2,At,1,1,"nb-icon",7),t.TgZ(3,"div",8),t._UZ(4,"img",9),t.qZA(),t.TgZ(5,"div",10)(6,"div",11)(7,"p",12),t._uU(8,"Workstation:"),t.qZA(),t.TgZ(9,"p",13),t._uU(10),t.qZA()(),t.TgZ(11,"div",11)(12,"p",12),t._uU(13,"Activity:"),t.qZA(),t.TgZ(14,"p",13),t._uU(15),t.qZA()(),t.TgZ(16,"div",11)(17,"p",12),t._uU(18,"Short:"),t.qZA(),t.TgZ(19,"p",13),t._uU(20),t.qZA()()()()()),2&i){const e=n.$implicit;t.xp6(2),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(8),t.Oqu(e.displayValue),t.xp6(5),t.Oqu(e.activity.displayValue),t.xp6(5),t.Oqu(e.code)}}function Zt(i,n){if(1&i&&(t.TgZ(0,"div",3)(1,"h2",3),t._uU(2),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,xt,21,4,"div",5),t.qZA()()),2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.workstations)}}function It(i,n){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Zt,5,2,"div",2),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.dataTree)}}let C=class{constructor(n,e,o){this.cdr=n,this.workcenterApi=e,this.workstationApi=o,this.workcenters=[],this.workstations=[],this.dataAvalaible=!1,this.dataTree=[]}ngOnInit(){this.getData()}getData(){(0,A.D)(this.workcenterApi.dataWorkCenterListGet(),this.workstationApi.dataWorkstationListGet()).pipe((0,u.t)(this)).subscribe({next:([n,e])=>{this.workcenters=n,this.workstations=e,this.dataAvalaible=!0,this.buildDataTree(),this.cdr.markForCheck()}})}buildDataTree(){const n=[...this.workcenters].map(e=>{var o;return null===(o=e.workstations)||void 0===o||o.forEach((r,a)=>{const s=r.reference,p=this.workstations.find(m=>m.uuid===s);e.workstations[a]=Object.assign(Object.assign({},e.workstations[a]),p)}),e});this.dataTree=n}getWarningInfo(n){return n.map(o=>o.displayValue).join(". ")}};C.\u0275fac=function(n){return new(n||C)(t.Y36(t.sBO),t.Y36(h.Uv),t.Y36(h.F))},C.\u0275cmp=t.Xpm({type:C,selectors:[["app-overview"]],decls:3,vars:2,consts:[[3,"nbSpinner"],[4,"ngIf"],["class","mb-3",4,"ngFor","ngForOf"],[1,"mb-3"],[1,"row"],[4,"ngFor","ngForOf"],[1,"item-card"],["nbTooltipStatus","primary","class","item-card__warning warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],[1,"item-card__image-wrapper"],["src","assets/images/packing.jpg","alt",""],[1,"item-card__content"],[1,"item-card__text"],[1,"item-card__label"],[1,"item-card__value"],["nbTooltipStatus","primary","icon","warning",1,"item-card__warning","warning-icon",3,"nbTooltip"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,It,2,1,"div",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvalaible),t.xp6(1),t.Q6J("ngIf",e.dataAvalaible))},directives:[c.Q7R,d.O5,d.sg,c.fMN,c.jNv],styles:[""]}),C=(0,w.gn)([(0,u.c)()],C);const Nt=[{path:"overview",component:C},{path:"activity",component:Ct},{path:"workcenter",component:(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-workcenters"]],decls:6,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Workcenters"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4," View and define your work centers here. A work center can contain zero or more workstations. These workstations can be linked to the work center in the details view.\n"),t.qZA(),t._UZ(5,"app-workcenter-table"))},directives:[b],styles:[""],changeDetection:0}),i})()},{path:"workstation",component:(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-workstations"]],decls:6,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"Workstations"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4,"View and define your work stations here."),t.qZA(),t._UZ(5,"app-workstation-table"))},directives:[T],styles:[""],changeDetection:0}),i})()},{path:"flow",component:wt},{path:"",pathMatch:"full",redirectTo:"overview"},{path:"**",component:yt.r}];let qt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[E.Bz.forChild(Nt),kt.n],E.Bz]}),i})(),St=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez,l.u5,l.UX,qt,c.T2N,c.zyh,c.KdK,c._WB,c.IIj,c.EoG,F,c.uuI,c.rgH,N.r,c.nKr,c.COg,q]]}),i})()}}]);