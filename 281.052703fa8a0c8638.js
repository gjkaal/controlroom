"use strict";(self.webpackChunkechelon=self.webpackChunkechelon||[]).push([[281],{7281:(Zt,x,g)=>{g.r(x),g.d(x,{SettingsOperationsModule:()=>Ft});var c=g(776),_=g(9808),t=g(5e3);let y=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-logistics-overview"]],decls:2,vars:0,template:function(o,n){1&o&&(t.TgZ(0,"p"),t._uU(1,"logistics-overview works!"),t.qZA())},styles:[""]}),i})();var T=g(655),A=g(567),m=g(4987),F=g(3242),a=g(3075),Z=g(2125);function N(i,e){if(1&i&&(t.TgZ(0,"div",16)(1,"span",17),t._uU(2,"Name is required"),t.qZA()()),2&i){const o=t.oxw();let n;t.xp6(1),t.Q6J("hidden",!(null!=(n=o.form.get("name"))&&null!=n.errors&&n.errors.required))}}function L(i,e){if(1&i&&(t.TgZ(0,"div",16)(1,"span",17),t._uU(2,"Short name is required"),t.qZA()()),2&i){const o=t.oxw();let n;t.xp6(1),t.Q6J("hidden",!(null!=(n=o.form.get("nameShort"))&&null!=n.errors&&n.errors.required))}}let I=(()=>{class i{constructor(o,n,s){this.formBuilder=o,this.dialog=n,this.cdr=s,this.completed=new t.vpe,this.back=new t.vpe,this.close=new t.vpe,this.form=this.formBuilder.group({name:["",a.kI.required],nameShort:["",a.kI.required]})}ngAfterViewInit(){var o,n;!this.newStream||this.form.patchValue({name:null!==(o=this.newStream.name)&&void 0!==o?o:"",nameShort:null!==(n=this.newStream.nameShort)&&void 0!==n?n:""})}ngAfterViewChecked(){this.cdr.detectChanges()}onBack(){this.back.emit(this.form.value)}confirm(){this.completed.emit(this.form.value)}onCloseDialog(){this.form.reset(),this.close.emit(!0),this.dialog.close()}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(a.qu),t.Y36(c.X4l),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-create-stream-dialog"]],outputs:{completed:"completed",back:"back",close:"close"},decls:28,vars:4,consts:[[1,"spinner-wrapper"],[1,"delete_action"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[3,"formGroup"],[1,"row","mb-3"],[1,"col-12","col-sm-3","d-flex","align-items-center"],["for","name",1,"mb-0"],[1,"col-12","col-sm-9"],["nbInput","","status","primary","placeholder","Enter stream name","formControlName","name"],["class","errors-wrapper",4,"ngIf"],["nbInput","","status","primary","placeholder","Enter short name","formControlName","nameShort"],[1,"modal-footer","modal-footer--centered-buttons","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"disabled","click"],[1,"errors-wrapper"],[1,"text-danger",3,"hidden"]],template:function(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",2)(4,"h4",3),t._uU(5,"Add Stream"),t.qZA(),t.TgZ(6,"nb-icon",4),t.NdJ("click",function(){return n.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"form",5)(9,"div",6)(10,"div",7)(11,"label",8),t._uU(12,"Stream:"),t.qZA()(),t.TgZ(13,"div",9),t._UZ(14,"input",10),t.YNc(15,N,3,1,"div",11),t.qZA()(),t.TgZ(16,"div",6)(17,"div",7)(18,"label",8),t._uU(19,"Short:"),t.qZA()(),t.TgZ(20,"div",9),t._UZ(21,"input",12),t.YNc(22,L,3,1,"div",11),t.qZA()()()(),t.TgZ(23,"div",13)(24,"button",14),t.NdJ("click",function(){return n.onBack()}),t._uU(25,"Back"),t.qZA(),t.TgZ(26,"button",15),t.NdJ("click",function(){return n.confirm()}),t._uU(27," Next "),t.qZA()()()(),t.BQk()),2&o){let s,r;t.xp6(8),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("ngIf",!(null!=(s=n.form.get("name"))&&s.valid)&&((null==(s=n.form.get("name"))?null:s.dirty)||(null==(s=n.form.get("name"))?null:s.touched))),t.xp6(7),t.Q6J("ngIf",!(null!=(r=n.form.get("nameShort"))&&r.valid)&&((null==(r=n.form.get("nameShort"))?null:r.dirty)||(null==(r=n.form.get("nameShort"))?null:r.touched))),t.xp6(4),t.Q6J("disabled",n.form.invalid)}},directives:[c.Asz,c.ndF,c.fMN,c.yKW,a._Y,a.JL,a.sg,c.h8i,a.Fj,a.JJ,a.u,_.O5,c.DPz],styles:[""]}),i})();var v=g(2192);function O(i,e){1&i&&(t.TgZ(0,"span",22),t._uU(1," This field is required "),t.qZA())}function q(i,e){1&i&&(t.TgZ(0,"span",22),t._uU(1," This field is required "),t.qZA())}function J(i,e){if(1&i&&t._UZ(0,"i",23),2&i){const o=t.oxw().$implicit,n=t.oxw(3);t.Q6J("nbTooltip",n.getWarningInfo(o.missingLinks))}}function R(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",24),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().index;return t.oxw(3).toggleEdit(s)}),t.qZA()}}const D=function(i){return{"table-icon":!0,disabled:i}};function E(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",25),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().index;return t.oxw(3).saveEdit(s)}),t.qZA()}if(2&i){const o=t.oxw().index,n=t.oxw(3);let s;t.Q6J("ngClass",t.VKq(1,D,null==(s=n.getControl(o).get("name"))?null:s.getError("required")))}}function M(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",26),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().index;return t.oxw(3).cancelEdit(s)}),t.qZA()}}function P(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",27),t.NdJ("click",function(){t.CHM(o);const s=t.oxw(),r=s.$implicit,l=s.index;return t.oxw(3).onDelete(r.uuid,l)}),t.qZA()}}function U(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"tr",11)(1,"td"),t._UZ(2,"input",12),t.YNc(3,O,2,0,"span",13),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",14),t.YNc(6,q,2,0,"span",13),t.qZA(),t.TgZ(7,"td")(8,"i",15),t.NdJ("click",function(){const s=t.CHM(o),r=s.$implicit,l=s.index;return t.oxw(3).onOpenConnectionPopup(r,l)}),t.qZA()(),t.TgZ(9,"td")(10,"div",16),t.YNc(11,J,1,1,"i",17),t.YNc(12,R,1,0,"i",18),t.YNc(13,E,1,3,"i",19),t.YNc(14,M,1,0,"i",20),t.YNc(15,P,1,0,"i",21),t.qZA()(),t._UZ(16,"td"),t.qZA()}if(2&i){const o=e.$implicit,n=e.index,s=t.oxw(3);let r,l;t.Q6J("formGroupName",n),t.xp6(2),t.s9C("id",o.name),t.s9C("value",o.name),t.xp6(1),t.Q6J("ngIf",(null==(r=s.getControl(n).get("name"))?null:r.touched)&&(null==(r=s.getControl(n).get("name"))?null:r.getError("required"))),t.xp6(2),t.s9C("id",o.nameShort),t.s9C("value",o.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(l=s.getControl(n).get("nameShort"))?null:l.touched)&&(null==(l=s.getControl(n).get("nameShort"))?null:l.getError("required"))),t.xp6(2),t.Gre("iconEcheclon icon-",null!=o.missingLinks&&o.missingLinks.length?"broken":"","connection connection-icon ml-1 cursor-pointer"),t.xp6(3),t.Q6J("ngIf","Warning"===o.linkStatus||"Critical"===o.linkStatus),t.xp6(1),t.Q6J("ngIf",s.formControlState(n)),t.xp6(1),t.Q6J("ngIf",!s.formControlState(n)),t.xp6(1),t.Q6J("ngIf",!s.formControlState(n)),t.xp6(1),t.Q6J("ngIf",s.formControlState(n))}}function Q(i,e){if(1&i&&(t.ynx(0),t.YNc(1,U,17,15,"tr",10),t.BQk()),2&i){const o=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",o.streamsList)}}function Y(i,e){1&i&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2,"There are no streams to display."),t.qZA()())}function G(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div")(1,"table",2)(2,"thead")(3,"tr")(4,"th",3),t._uU(5,"Stream"),t.qZA(),t.TgZ(6,"th",4),t._uU(7,"Short"),t.qZA(),t.TgZ(8,"th",5),t._uU(9,"Connections"),t.qZA(),t.TgZ(10,"th",6),t._uU(11,"Actions"),t.qZA(),t.TgZ(12,"th",4)(13,"nb-icon",7),t.NdJ("click",function(){return t.CHM(o),t.oxw().onOpenCreateStreamDialog()}),t.qZA()()()(),t.TgZ(14,"tbody",8),t.YNc(15,Q,2,1,"ng-container",0),t.YNc(16,Y,3,0,"ng-template",null,9,t.W1O),t.qZA()()()}if(2&i){const o=t.MAs(17),n=t.oxw();t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(13),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngIf",n.streamsList.length)("ngIfElse",o)}}function B(i,e){1&i&&t._UZ(0,"div",29),2&i&&t.Q6J("nbSpinner",!0)}let h=class{constructor(e,o,n,s,r,l){this.cdr=e,this.flowsApi=o,this.streamApi=n,this.toastrService=s,this.dialog=r,this.formBuilder=l,this.streamsList=[],this.streamsSelectList=[],this.flowsSelectList=[],this.addNewFlow=!1,this.checked=!1,this.dataAvalaible=!1,this.positions=c.fe3,this.form=new a.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.getStreamsData(),this.getFlowsSelectList(),this.getStreamsSelectList()}toggleActivity(e){this.checked=e}getStreamsSelectList(){this.streamApi.dataOrchestrationAllStreamsGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.streamsSelectList=null==e?void 0:e.selectItems,this.cdr.markForCheck()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Getting streams list failed, please try again later.",3e3)}})}getStreamsData(){this.streamApi.dataOrchestrationListGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.dataAvalaible=!0,this.streamsList=e,this.cdr.markForCheck(),this.buildForm()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Getting flows list failed, please try again later.",3e3)}})}getFlowsSelectList(){this.flowsApi.dataFlowAllFlowsGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.flowsSelectList=null==e?void 0:e.selectItems,this.cdr.markForCheck()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Getting flows select list failed, please try again later.",3e3)}})}add(){const e=Object.assign({},this.newStream);this.streamApi.dataOrchestrationCreatePost(e).pipe((0,m.t)(this)).subscribe({next:o=>{var n;this.getStreamsData(),this.getFlowsSelectList(),this.showToast(this.positions.TOP_RIGHT,"success","Stream succesfully created.",3e3),this.newStream=void 0,(null===(n=this.flowsSelectList)||void 0===n?void 0:n.length)&&this.onOpenConnectionPopup()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Adding new stream failed, please try again later.",3e3)}})}onOpenCreateStreamDialog(){const e=this.dialog.open(I);e.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{e.close(),this.newStream=void 0}),e.componentRef.instance.newStream=this.newStream,e.componentRef.instance.back.pipe((0,m.t)(this)).subscribe(o=>{if(o){const{name:n,nameShort:s}=o;this.newStream={name:n,nameShort:s}}e.close()}),e.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(o=>{if(o){const{name:n,nameShort:s}=o;this.newStream={name:n,nameShort:s},e.close(),this.add()}}),e.componentRef.instance.close.pipe((0,m.t)(this)).subscribe(()=>{this.newStream=void 0})}clearNewStream(){this.newStream=void 0,this.selectedFlows=[]}onOpenConnectionPopup(e,o){var n,s,r,l,u;const d=this.dialog.open(F.w);if(d.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{this.selectedFlows=[],d.close()}),o){const p=this.streamsList[o],b=(null===(n=null==p?void 0:p.flows)||void 0===n?void 0:n.length)?null===(s=this.flowsSelectList)||void 0===s?void 0:s.filter(C=>{var w;return!(null===(w=null==p?void 0:p.flows)||void 0===w?void 0:w.find(S=>S.reference===C.reference))}):(null===(r=this.flowsSelectList)||void 0===r?void 0:r.length)?[...this.flowsSelectList]:[];d.componentRef.instance.items=b,d.componentRef.instance.selectedItems=null!==(l=null==p?void 0:p.flows)&&void 0!==l?l:[],d.componentRef.instance.rightTitle=`Stream: ${null==e?void 0:e.name}`}else d.componentRef.instance.items=this.flowsSelectList,d.componentRef.instance.selectedItems=null!==(u=this.selectedFlows)&&void 0!==u?u:[],d.componentRef.instance.rightTitle="Stream";d.componentRef.instance.leftTitle="Flows",d.componentRef.instance.title="Connect a Flow to the Stream",d.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(p=>{this.selectedFlows=p,this.addConnections(o),d.close()}),d.componentRef.instance.close.pipe((0,m.t)(this)).subscribe(()=>{this.selectedFlows=[]})}addConnections(e){var o,n;if(!(null===(o=this.flowsSelectList)||void 0===o?void 0:o.length))return;const s=null===(n=this.selectedFlows)||void 0===n?void 0:n.map(r=>{var l;const u={flow:r,stream:this.streamsSelectList?this.streamsSelectList[null!=e?e:(null===(l=this.streamsSelectList)||void 0===l?void 0:l.length)-1]:{},removeExistingConnection:!0};return this.streamApi.dataOrchestrationAddLinkPost(u)});(0,A.D)(s).pipe((0,m.t)(this)).subscribe({next:r=>{this.getStreamsData(),this.showToast(this.positions.TOP_RIGHT,"success","Streams connections succesfully created.",3e3),this.clearNewStream()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Adding stream connections, please try again later.",3e3)}})}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.streamsList].map(e=>{var o,n,s;return this.createStreamGroup(!0,null!==(o=e.name)&&void 0!==o?o:"",null!==(n=e.nameShort)&&void 0!==n?n:"",null!==(s=e.uuid)&&void 0!==s?s:"")}))})}createStreamGroup(e=!0,o="",n="",s=""){return this.formBuilder.group({name:new a.NI({value:o,disabled:e},a.kI.required),nameShort:new a.NI({value:n,disabled:e},a.kI.required),uuid:new a.NI({value:s,disabled:e})})}onRemove(e){this.streamsList.splice(e,1),this.form.get("formArrayName").removeAt(e),this.cdr.markForCheck()}toggleEdit(e){const o=this.form.get("formArrayName");"DISABLED"===o.controls[e].status?o.controls[e].enable():o.controls[e].disable()}getControl(e){return this.form.get("formArrayName").controls[e]}cancelEdit(e){this.toggleEdit(e);const o=this.form.get("formArrayName"),n=this.streamsList.find(s=>s.uuid===o.controls[e].value.uuid);o.controls[e].patchValue({name:null==n?void 0:n.name,nameShort:null==n?void 0:n.nameShort})}formControlState(e){return this.form.get("formArrayName").controls[e].disabled}getControlsArray(){return this.form.get("formArrayName")}saveEdit(e){const n=this.form.get("formArrayName").controls[e],{name:s,nameShort:r,uuid:l}=n.value;this.streamApi.dataOrchestrationUpdateUuidPut(l,{name:s,nameShort:r,uuid:l}).pipe((0,m.t)(this)).subscribe({next:d=>{this.getStreamsData(),this.getFlowsSelectList(),this.getStreamsSelectList(),this.showToast(this.positions.TOP_RIGHT,"success","Stream succesfully updated.",3e3)},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}})}getWarningInfo(e){const o=null==e?void 0:e.map(n=>n.displayValue).join(". ");return null!=o?o:""}onDelete(e,o){const n=this.dialog.open(Z.D),s=this.streamsList[o].name;n.componentRef.instance.title="Delete stream",n.componentRef.instance.text=`When you delete the Stream ${s} you will also lose the connection with the flows. Are you sure you want to delete the Stream ${s}?`,n.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{n.close()}),n.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(r=>{e?this.streamApi.dataOrchestrationDeleteUuidDelete(e).pipe((0,m.t)(this)).subscribe({next:()=>{this.onRemove(o),this.cdr.markForCheck(),n.close(),this.showToast(this.positions.TOP_RIGHT,"success","Stream succesfully removed.",3e3)},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(o),n.close())})}showToast(e,o,n,s=5e3,r=""){!n||this.toastrService.show(o||"Success",n,{icon:r,position:e,status:o,duration:s,destroyByClick:!0,limit:1})}};function H(i,e){if(1&i&&(t.TgZ(0,"nb-option",14),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o.displayValue," ")}}function W(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"label",10),t._uU(4,"Stream"),t.qZA()(),t.TgZ(5,"div",11)(6,"nb-select",12),t.NdJ("selectedChange",function(s){return t.CHM(o),t.oxw().onSelectStream(s)}),t.YNc(7,H,2,2,"nb-option",13),t.qZA()()()()}if(2&i){const o=t.oxw();t.xp6(6),t.Q6J("selected",o.selectedStream),t.xp6(1),t.Q6J("ngForOf",o.streams)}}function z(i,e){1&i&&(t.TgZ(0,"p"),t._uU(1,"No streams have been created yet"),t.qZA())}h.\u0275fac=function(e){return new(e||h)(t.Y36(t.sBO),t.Y36(v.OF),t.Y36(v.EI),t.Y36(c.quB),t.Y36(c.Gln),t.Y36(a.qu))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-logistics-streams"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"table","stream-table","overflow-auto",3,"formGroup"],["scope","col",1,"streams-col"],["scope","col"],["scope","col",1,"connections-col"],["scope","col",1,"actions-col"],["title","Edit","icon","add_circle",1,"cursor-pointer",3,"click"],[3,"formArrayName"],["noData",""],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],[3,"click"],[1,"icons-wrapper"],["class","iconEcheclon icon-warning_red cursor-pointer mr-3",3,"nbTooltip",4,"ngIf"],["class","iconEcheclon icon-edit cursor-pointer mr-1",3,"click",4,"ngIf"],["class","iconEcheclon icon-confirm cursor-pointer mr-1",3,"ngClass","click",4,"ngIf"],["class","iconEcheclon icon-close cursor-pointer",3,"click",4,"ngIf"],["class","iconEcheclon icon-bin cursor-pointer",3,"click",4,"ngIf"],[1,"text-danger"],[1,"iconEcheclon","icon-warning_red","cursor-pointer","mr-3",3,"nbTooltip"],[1,"iconEcheclon","icon-edit","cursor-pointer","mr-1",3,"click"],[1,"iconEcheclon","icon-confirm","cursor-pointer","mr-1",3,"ngClass","click"],[1,"iconEcheclon","icon-close","cursor-pointer",3,"click"],[1,"iconEcheclon","icon-bin","cursor-pointer",3,"click"],["colspan","7",1,"border-0","text-center"],[1,"spinner-wrapper",3,"nbSpinner"]],template:function(e,o){if(1&e&&(t.YNc(0,G,18,4,"div",0),t.YNc(1,B,1,1,"ng-template",null,1,t.W1O)),2&e){const n=t.MAs(2);t.Q6J("ngIf",o.dataAvalaible)("ngIfElse",n)}},directives:[_.O5,a.JL,a.sg,c.fMN,a.CE,_.sg,a.x0,c.h8i,a.Fj,a.JJ,a.u,c.jNv,_.mk,c.Q7R],styles:[".stream-table[_ngcontent-%COMP%]{border:none}.stream-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:2px solid #dee2e6;vertical-align:middle}.stream-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}.stream-table[_ngcontent-%COMP%]   .streams-col[_ngcontent-%COMP%]{width:230px}.stream-table[_ngcontent-%COMP%]   .connections-col[_ngcontent-%COMP%]{width:160px}.stream-table[_ngcontent-%COMP%]   .actions-col[_ngcontent-%COMP%]{width:230px}.connection-icon[_ngcontent-%COMP%]:not(.icon-brokenconnection){font-size:13px}.drag-icon[_ngcontent-%COMP%]{font-size:30px}"],changeDetection:0}),h=(0,T.gn)([(0,m.c)()],h);let j=(()=>{class i{constructor(o){this.dialog=o,this.streams=[],this.completed=new t.vpe,this.close=new t.vpe}ngOnInit(){}cancel(){this.dialog.close(),this.close.emit(!0)}confirm(){this.completed.emit(this.selectedStream)}onSelectStream(o){this.selectedStream=o}onCloseDialog(){this.cancel()}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(c.X4l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-select-stream-dialog"]],outputs:{completed:"completed",close:"close"},decls:16,vars:2,consts:[[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[4,"ngIf","ngIfElse"],["noStreams",""],[1,"modal-footer","modal-footer--centered-buttons","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"],[1,"row"],[1,"col-12","col-sm-3","d-flex","align-items-center"],["for","stream",1,"mb-0"],[1,"col-12","col-sm-9"],["id","stream","status","primary","placeholder","Select stream...",1,"select",3,"selected","selectedChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"div")(2,"nb-card",0)(3,"nb-card-header",0)(4,"h4",1),t._uU(5,"Select stream"),t.qZA(),t.TgZ(6,"nb-icon",2),t.NdJ("click",function(){return n.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body"),t.YNc(8,W,8,2,"div",3),t.YNc(9,z,2,0,"ng-template",null,4,t.W1O),t.qZA(),t.TgZ(11,"div",5)(12,"button",6),t.NdJ("click",function(){return n.cancel()}),t._uU(13,"Cancel"),t.qZA(),t.TgZ(14,"button",7),t.NdJ("click",function(){return n.confirm()}),t._uU(15,"Next"),t.qZA()()()(),t.BQk()),2&o){const s=t.MAs(10);t.xp6(8),t.Q6J("ngIf",null==n.streams?null:n.streams.length)("ngIfElse",s)}},directives:[c.Asz,c.ndF,c.fMN,c.yKW,_.O5,c.rs,_.sg,c.q51,c.DPz],styles:["nb-card[_ngcontent-%COMP%]{min-width:500px}nb-card[_ngcontent-%COMP%]   nb-select[_ngcontent-%COMP%]{max-width:210px;width:210px}"]}),i})();function $(i,e){if(1&i&&(t.TgZ(0,"div",24)(1,"span",25),t._uU(2,"Name is required"),t.qZA()()),2&i){const o=t.oxw();let n;t.xp6(1),t.Q6J("hidden",!(null!=(n=o.form.get("name"))&&null!=n.errors&&n.errors.required))}}function V(i,e){if(1&i&&(t.TgZ(0,"div",24)(1,"span",25),t._uU(2,"Short name is required"),t.qZA()()),2&i){const o=t.oxw();let n;t.xp6(1),t.Q6J("hidden",!(null!=(n=o.form.get("nameShort"))&&null!=n.errors&&n.errors.required))}}function X(i,e){if(1&i&&(t.TgZ(0,"nb-option",18),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o.displayValue," ")}}let K=(()=>{class i{constructor(o,n,s){this.formBuilder=o,this.dialog=n,this.cdr=s,this.flowsSelectList=[],this.completed=new t.vpe,this.back=new t.vpe,this.close=new t.vpe,this.form=this.formBuilder.group({name:["",a.kI.required],nameShort:["",a.kI.required],isActive:[!0],nextFlow:[{}],addNext:["0"]})}ngAfterViewInit(){var o,n,s,r;!this.newFlow||this.form.patchValue({name:null!==(o=this.newFlow.name)&&void 0!==o?o:"",nameShort:null!==(n=this.newFlow.nameShort)&&void 0!==n?n:"",isActive:null!==(s=this.newFlow.isActive)&&void 0!==s?s:"1",nextFlow:null!==(r=this.newFlow.nextFlow)&&void 0!==r?r:""})}ngAfterViewChecked(){this.cdr.detectChanges()}onBack(){this.back.emit(this.form.value)}confirm(){this.completed.emit(this.form.value)}onCloseDialog(){this.form.reset(),this.close.emit(!0),this.dialog.close()}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(a.qu),t.Y36(c.X4l),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-create-flow-dialog"]],outputs:{completed:"completed",back:"back",close:"close"},decls:50,vars:7,consts:[[1,"spinner-wrapper"],[1,"delete_action"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[3,"formGroup"],[1,"row","mb-3"],[1,"col-12","col-sm-3","d-flex","align-items-center"],["for","name",1,"mb-0"],[1,"col-12","col-sm-9"],["nbInput","","status","primary","placeholder","Enter flow name","formControlName","name"],["class","errors-wrapper",4,"ngIf"],["nbInput","","status","primary","placeholder","Enter short name","formControlName","nameShort"],["for","nextFlow",1,"mb-0"],["id","nextFlow","status","primary","placeholder","Select flow...","formControlName","nextFlow",1,"select"],[3,"value",4,"ngFor","ngForOf"],[1,"row","mb-2"],["status","control","formControlName","isActive","name","reactive-forms-group",1,"d-flex"],[3,"value"],[1,"row"],["status","control","formControlName","addNext",1,"activity-checkbox","ml-1"],[1,"modal-footer","modal-footer--centered-buttons","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"disabled","click"],[1,"errors-wrapper"],[1,"text-danger",3,"hidden"]],template:function(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",2)(4,"h4",3),t._uU(5,"Add flow"),t.qZA(),t.TgZ(6,"nb-icon",4),t.NdJ("click",function(){return n.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"form",5)(9,"div",6)(10,"div",7)(11,"label",8),t._uU(12,"Flow:"),t.qZA()(),t.TgZ(13,"div",9),t._UZ(14,"input",10),t.YNc(15,$,3,1,"div",11),t.qZA()(),t.TgZ(16,"div",6)(17,"div",7)(18,"label",8),t._uU(19,"Short:"),t.qZA()(),t.TgZ(20,"div",9),t._UZ(21,"input",12),t.YNc(22,V,3,1,"div",11),t.qZA()(),t.TgZ(23,"div",6)(24,"div",7)(25,"label",13),t._uU(26,"Next flow"),t.qZA()(),t.TgZ(27,"div",9)(28,"nb-select",14),t.YNc(29,X,2,2,"nb-option",15),t.qZA()()(),t.TgZ(30,"div",16)(31,"div",7)(32,"label",8),t._uU(33,"Active:"),t.qZA()(),t.TgZ(34,"div",9)(35,"nb-radio-group",17)(36,"nb-radio",18),t._uU(37,"Yes"),t.qZA(),t.TgZ(38,"nb-radio",18),t._uU(39,"No"),t.qZA()()()(),t.TgZ(40,"div",19),t._UZ(41,"div",7),t.TgZ(42,"div",9)(43,"nb-checkbox",20),t._uU(44,"Add new flow"),t.qZA()()()()(),t.TgZ(45,"div",21)(46,"button",22),t.NdJ("click",function(){return n.onBack()}),t._uU(47,"Back"),t.qZA(),t.TgZ(48,"button",23),t.NdJ("click",function(){return n.confirm()}),t._uU(49," Next "),t.qZA()()()(),t.BQk()),2&o){let s,r;t.xp6(8),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("ngIf",!(null!=(s=n.form.get("name"))&&s.valid)&&((null==(s=n.form.get("name"))?null:s.dirty)||(null==(s=n.form.get("name"))?null:s.touched))),t.xp6(7),t.Q6J("ngIf",!(null!=(r=n.form.get("nameShort"))&&r.valid)&&((null==(r=n.form.get("nameShort"))?null:r.dirty)||(null==(r=n.form.get("nameShort"))?null:r.touched))),t.xp6(7),t.Q6J("ngForOf",n.flowsSelectList),t.xp6(7),t.Q6J("value",!0),t.xp6(2),t.Q6J("value",!1),t.xp6(10),t.Q6J("disabled",n.form.invalid)}},directives:[c.Asz,c.ndF,c.fMN,c.yKW,a._Y,a.JL,a.sg,c.h8i,a.Fj,a.JJ,a.u,_.O5,c.rs,_.sg,c.q51,c.MFI,c.r3g,c.NTf,c.DPz],styles:["nb-card[_ngcontent-%COMP%]{min-width:500px}nb-card[_ngcontent-%COMP%]   nb-select[_ngcontent-%COMP%], nb-card[_ngcontent-%COMP%]   [nbInput][_ngcontent-%COMP%]{max-width:210px;width:210px}"]}),i})();function tt(i,e){1&i&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function et(i,e){1&i&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function ot(i,e){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o.code," ")}}function nt(i,e){if(1&i&&t._UZ(0,"i",26),2&i){const o=t.oxw().$implicit,n=t.oxw(3);t.Q6J("nbTooltip",n.getWarningInfo(o.missingLinks))}}function it(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",27),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().index;return t.oxw(3).toggleEdit(s)}),t.qZA()}}const st=function(i){return{disabled:i}};function rt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",28),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().index;return t.oxw(3).saveEdit(s)}),t.qZA()}if(2&i){const o=t.oxw().index,n=t.oxw(3);let s;t.Q6J("ngClass",t.VKq(1,st,null==(s=n.getControl(o).get("name"))?null:s.getError("required")))}}function ct(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",29),t.NdJ("click",function(){t.CHM(o);const s=t.oxw().index;return t.oxw(3).cancelEdit(s)}),t.qZA()}}function lt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"i",30),t.NdJ("click",function(){t.CHM(o);const s=t.oxw(),r=s.$implicit,l=s.index;return t.oxw(3).onDelete(r.uuid,l)}),t.qZA()}}function at(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,tt,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,et,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"nb-select",12),t.YNc(9,ot,2,2,"nb-option",13),t.qZA()(),t.TgZ(10,"td")(11,"div",14)(12,"nb-checkbox",15),t._uU(13,"Active"),t.qZA()()(),t.TgZ(14,"td")(15,"i",16),t.NdJ("click",function(){const s=t.CHM(o),r=s.$implicit,l=s.index;return t.oxw(3).onOpenConnectionPopup(r,l)}),t.qZA()(),t.TgZ(16,"td")(17,"div",17),t.YNc(18,nt,1,1,"i",18),t.YNc(19,it,1,0,"i",19),t.YNc(20,rt,1,3,"i",20),t.YNc(21,ct,1,0,"i",21),t.YNc(22,lt,1,0,"i",22),t.qZA()(),t.TgZ(23,"td"),t._UZ(24,"i",23),t.qZA()()}if(2&i){const o=e.$implicit,n=e.index,s=t.oxw(3);let r,l;t.Q6J("formGroupName",n),t.xp6(2),t.s9C("id",o.name),t.s9C("value",o.name),t.xp6(1),t.Q6J("ngIf",(null==(r=s.getControl(n).get("name"))?null:r.touched)&&(null==(r=s.getControl(n).get("name"))?null:r.getError("required"))),t.xp6(2),t.s9C("id",o.nameShort),t.s9C("value",o.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(l=s.getControl(n).get("nameShort"))?null:l.touched)&&(null==(l=s.getControl(n).get("nameShort"))?null:l.getError("required"))),t.xp6(3),t.Q6J("ngForOf",s.flowsSelectList),t.xp6(6),t.Gre("iconEcheclon icon-",o.missingLinks?"broken":"","connection connection-icon ml-1 cursor-pointer"),t.xp6(3),t.Q6J("ngIf","Warning"===o.linkStatus||"Critical"===o.linkStatus),t.xp6(1),t.Q6J("ngIf",s.formControlState(n)),t.xp6(1),t.Q6J("ngIf",!s.formControlState(n)),t.xp6(1),t.Q6J("ngIf",!s.formControlState(n)),t.xp6(1),t.Q6J("ngIf",s.formControlState(n))}}function mt(i,e){if(1&i&&(t.ynx(0),t.YNc(1,at,25,16,"tr",7),t.BQk()),2&i){const o=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",o.flowsList)}}function dt(i,e){1&i&&(t.TgZ(0,"tr")(1,"td",31),t._uU(2,"There are no flows to display."),t.qZA()())}function pt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div")(1,"table",2)(2,"thead")(3,"tr")(4,"th",3),t._uU(5,"Flows"),t.qZA(),t.TgZ(6,"th",3),t._uU(7,"Short"),t.qZA(),t.TgZ(8,"th",3),t._uU(9,"Next Flow"),t.qZA(),t.TgZ(10,"th",3),t._uU(11,"Active"),t.qZA(),t.TgZ(12,"th",3),t._uU(13,"Connections"),t.qZA(),t.TgZ(14,"th",3),t._uU(15,"Actions"),t.qZA(),t.TgZ(16,"th",3)(17,"nb-icon",4),t.NdJ("click",function(){return t.CHM(o),t.oxw().onOpenSelectStreamDialog()}),t.qZA()()()(),t.TgZ(18,"tbody",5),t.YNc(19,mt,2,1,"ng-container",0),t.YNc(20,dt,3,0,"ng-template",null,6,t.W1O),t.qZA()()()}if(2&i){const o=t.MAs(21),n=t.oxw();t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(17),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngIf",n.flowsList.length)("ngIfElse",o)}}function ut(i,e){1&i&&t._UZ(0,"div",32),2&i&&t.Q6J("nbSpinner",!0)}let f=class{constructor(e,o,n,s,r,l,u){this.cdr=e,this.flowsApi=o,this.streamApi=n,this.toastrService=s,this.dialog=r,this.workstationApi=l,this.formBuilder=u,this.flowsList=[],this.streamsSelectList=[],this.flowsSelectList=[],this.addNewFlow=!1,this.checked=!1,this.dataAvalaible=!1,this.positions=c.fe3,this.form=new a.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.getFlowsData(),this.getFlowsSelectList(),this.getStreamsSelectList(),this.getWorkstationsSelectList()}toggleActivity(e){this.checked=e}getWorkstationsSelectList(){this.workstationApi.dataWorkstationAllWorkstationsGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.workstationsSelectList=e.selectItems,this.cdr.markForCheck()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}})}getFlowsData(){this.flowsApi.dataFlowListGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.dataAvalaible=!0,this.flowsList=e,this.cdr.markForCheck(),this.buildForm()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Getting flows list failed, please try again later.",3e3)}})}getStreamsSelectList(){this.streamApi.dataOrchestrationAllStreamsGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.streamsSelectList=null==e?void 0:e.selectItems,this.cdr.markForCheck()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Getting streams list failed, please try again later.",3e3)}})}getFlowsSelectList(){this.flowsApi.dataFlowAllFlowsGet().pipe((0,m.t)(this)).subscribe({next:e=>{this.flowsSelectList=null==e?void 0:e.selectItems,this.cdr.markForCheck()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Getting flows select list failed, please try again later.",3e3)}})}add(){var e;const o=Object.assign(Object.assign({},this.newFlow),{flowOrchestration:null!==(e=this.newFlowStream)&&void 0!==e?e:{}});this.flowsApi.dataFlowCreatePost(o).pipe((0,m.t)(this)).subscribe({next:n=>{this.getFlowsData(),this.getFlowsSelectList(),this.showToast(this.positions.TOP_RIGHT,"success","Flow succesfully created.",3e3),this.newFlow=void 0,this.newFlowStream=void 0,this.onOpenConnectionPopup()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Adding mew flow failed, please try again later.",3e3)}})}onOpenSelectStreamDialog(){const e=this.dialog.open(j);e.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{e.close(),this.newFlow=void 0}),e.componentRef.instance.selectedStream=this.newFlowStream,e.componentRef.instance.streams=this.streamsSelectList,e.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(o=>{o&&(this.newFlowStream=o),e.close(),this.onOpenCreateFlowDialog()}),e.componentRef.instance.close.pipe((0,m.t)(this)).subscribe(()=>{this.clearNewFlow()})}onOpenCreateFlowDialog(){const e=this.dialog.open(K);e.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{e.close(),this.newFlow=void 0,this.newFlowStream=void 0,this.addNewFlow=!1}),e.componentRef.instance.newFlow=this.newFlow,e.componentRef.instance.flowsSelectList=this.flowsSelectList,e.componentRef.instance.back.pipe((0,m.t)(this)).subscribe(o=>{if(o){const{name:n,nameShort:s,isActive:r,nextFlow:l,addNext:u}=o;this.newFlow={name:n,nameShort:s,isActive:r,nextFlow:l},this.addNewFlow=u}e.close(),this.onOpenSelectStreamDialog()}),e.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(o=>{if(o){const{name:n,nameShort:s,isActive:r,nextFlow:l,addNext:u}=o;this.newFlow={name:n,nameShort:s,isActive:r,nextFlow:l},this.addNewFlow=u,e.close(),this.add()}}),e.componentRef.instance.close.pipe((0,m.t)(this)).subscribe(()=>{this.newFlow=void 0,this.newFlowStream=void 0})}clearNewFlow(){this.newFlow=void 0,this.newFlowStream=void 0,this.selectedWorkstations=[]}onOpenConnectionPopup(e,o){var n,s,r,l,u;const d=this.dialog.open(F.w);if(d.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{this.selectedWorkstations=[],d.close()}),o){const p=this.flowsList[o],b=(null===(n=null==p?void 0:p.workstations)||void 0===n?void 0:n.length)?null===(s=this.workstationsSelectList)||void 0===s?void 0:s.filter(C=>{var w;return!(null===(w=null==p?void 0:p.workstations)||void 0===w?void 0:w.find(S=>S.reference===C.reference))}):(null===(r=this.workstationsSelectList)||void 0===r?void 0:r.length)?[...this.workstationsSelectList]:[];d.componentRef.instance.items=b,d.componentRef.instance.selectedItems=null!==(l=null==p?void 0:p.workstations)&&void 0!==l?l:[],d.componentRef.instance.rightTitle=`Flow: ${null==e?void 0:e.name}`}else d.componentRef.instance.items=this.workstationsSelectList,d.componentRef.instance.selectedItems=null!==(u=this.selectedWorkstations)&&void 0!==u?u:[],d.componentRef.instance.rightTitle="Flow";d.componentRef.instance.leftTitle="Workstations",d.componentRef.instance.title="Connect a Workstation to the flow",d.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(p=>{this.selectedWorkstations=p,this.addConnections(o),d.close()}),d.componentRef.instance.close.pipe((0,m.t)(this)).subscribe(()=>{this.selectedWorkstations=[]})}addConnections(e){var o,n,s;if(!(null===(o=this.flowsSelectList)||void 0===o?void 0:o.length)||!(null===(n=this.workstationsSelectList)||void 0===n?void 0:n.length))return;const r=null===(s=this.selectedWorkstations)||void 0===s?void 0:s.map(l=>{var u;const d={workstation:l,flow:this.flowsSelectList?this.flowsSelectList[null!=e?e:(null===(u=this.flowsSelectList)||void 0===u?void 0:u.length)-1]:{},removeExistingConnection:!0};return this.flowsApi.dataFlowAddLinkPost(d)});(0,A.D)(r).pipe((0,m.t)(this)).subscribe({next:l=>{this.getFlowsData(),this.showToast(this.positions.TOP_RIGHT,"success","Flows connections succesfully created.",3e3),this.clearNewFlow(),e||(this.onOpenCreateFlowDialog(),this.addNewFlow=!1)},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Adding flow connections, please try again later.",3e3)}})}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.flowsList].map(e=>{var o,n,s,r,l;return this.createFlowGroup(!0,null!==(o=e.name)&&void 0!==o?o:"",null!==(n=e.nameShort)&&void 0!==n?n:"",null!==(s=e.uuid)&&void 0!==s?s:"",null!==(r=e.nextFlow)&&void 0!==r?r:"",null!==(l=e.isActive)&&void 0!==l&&l)}))})}createFlowGroup(e=!0,o="",n="",s="",r="",l=!1){return this.formBuilder.group({name:new a.NI({value:o,disabled:e},a.kI.required),nameShort:new a.NI({value:n,disabled:e},a.kI.required),uuid:new a.NI({value:s,disabled:e}),nextFlow:new a.NI({value:r,disabled:e}),isActive:new a.NI({value:l,disabled:e})})}onRemove(e){this.flowsList.splice(e,1),this.form.get("formArrayName").removeAt(e),this.cdr.markForCheck()}toggleEdit(e){const o=this.form.get("formArrayName");"DISABLED"===o.controls[e].status?o.controls[e].enable():o.controls[e].disable()}getControl(e){return this.form.get("formArrayName").controls[e]}cancelEdit(e){this.toggleEdit(e);const o=this.form.get("formArrayName"),n=this.flowsList.find(s=>s.uuid===o.controls[e].value.uuid);o.controls[e].patchValue({name:null==n?void 0:n.name,nameShort:null==n?void 0:n.nameShort})}formControlState(e){return this.form.get("formArrayName").controls[e].disabled}getControlsArray(){return this.form.get("formArrayName")}saveEdit(e){const n=this.form.get("formArrayName").controls[e];console.log(n);const{name:s,nameShort:r,isActive:l,nextFlow:u,uuid:d}=n.value;this.flowsApi.dataFlowUpdateUuidPut(d,{name:s,nameShort:r,isActive:l,nextFlow:u,uuid:d}).pipe((0,m.t)(this)).subscribe({next:b=>{this.getFlowsData(),this.getFlowsSelectList(),this.showToast(this.positions.TOP_RIGHT,"success","Flow succesfully updated.",3e3)},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}})}getWarningInfo(e){const o=null==e?void 0:e.map(n=>n.displayValue).join(". ");return null!=o?o:""}onDelete(e,o){const n=this.dialog.open(Z.D);n.componentRef.instance.title="Remove flow",n.componentRef.instance.text="Are you sure you want to remove this flow?",n.onBackdropClick.pipe((0,m.t)(this)).subscribe(()=>{n.close()}),n.componentRef.instance.completed.pipe((0,m.t)(this)).subscribe(s=>{e?this.flowsApi.dataFlowDeleteUuidDelete(e).pipe((0,m.t)(this)).subscribe({next:()=>{this.onRemove(o),this.cdr.markForCheck(),n.close(),this.showToast(this.positions.TOP_RIGHT,"success","Flow succesfully removed.",3e3)},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(o),n.close())})}showToast(e,o,n,s=5e3,r=""){!n||this.toastrService.show(o||"Success",n,{icon:r,position:e,status:o,duration:s,destroyByClick:!0,limit:1})}};f.\u0275fac=function(e){return new(e||f)(t.Y36(t.sBO),t.Y36(v.OF),t.Y36(v.EI),t.Y36(c.quB),t.Y36(c.Gln),t.Y36(v.F),t.Y36(a.qu))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-logistics-flows"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"table","flows-table","overflow-auto",3,"formGroup"],["scope","col"],["title","Edit","icon","add_circle",1,"cursor-pointer",3,"click"],[3,"formArrayName"],["noData",""],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["id","nextFlow","status","control","placeholder","Select flow...","formControlName","nextFlow",1,"editable-input"],[3,"value",4,"ngFor","ngForOf"],[1,"checkbox-container","d-flex","align-items-center"],["status","control","formControlName","isActive",1,"activity-checkbox","ml-1","editable-input"],[3,"click"],[1,"float-right","icons-wrapper"],["class","iconEcheclon icon-warning_red cursor-pointer mr-3",3,"nbTooltip",4,"ngIf"],["class","iconEcheclon icon-edit cursor-pointer mr-1",3,"click",4,"ngIf"],["class","iconEcheclon icon-confirm cursor-pointer mr-1",3,"ngClass","click",4,"ngIf"],["class","iconEcheclon icon-close cursor-pointer",3,"click",4,"ngIf"],["class","iconEcheclon icon-bin cursor-pointer",3,"click",4,"ngIf"],[1,"iconEcheclon","icon-drag","drag-icon","cursor-pointer"],[1,"text-danger"],[3,"value"],[1,"iconEcheclon","icon-warning_red","cursor-pointer","mr-3",3,"nbTooltip"],[1,"iconEcheclon","icon-edit","cursor-pointer","mr-1",3,"click"],[1,"iconEcheclon","icon-confirm","cursor-pointer","mr-1",3,"ngClass","click"],[1,"iconEcheclon","icon-close","cursor-pointer",3,"click"],[1,"iconEcheclon","icon-bin","cursor-pointer",3,"click"],["colspan","7",1,"border-0","text-center"],[1,"spinner-wrapper",3,"nbSpinner"]],template:function(e,o){if(1&e&&(t.YNc(0,pt,22,4,"div",0),t.YNc(1,ut,1,1,"ng-template",null,1,t.W1O)),2&e){const n=t.MAs(2);t.Q6J("ngIf",o.dataAvalaible)("ngIfElse",n)}},directives:[_.O5,a.JL,a.sg,c.fMN,a.CE,_.sg,a.x0,c.h8i,a.Fj,a.JJ,a.u,c.rs,c.q51,c.NTf,c.jNv,_.mk,c.Q7R],styles:[".flows-table[_ngcontent-%COMP%]{border:none}.flows-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:2px solid #dee2e6;vertical-align:middle}.flows-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}.connection-icon[_ngcontent-%COMP%]:not(.icon-brokenconnection){font-size:13px}.drag-icon[_ngcontent-%COMP%]{font-size:30px}"],changeDetection:0}),f=(0,T.gn)([(0,m.c)()],f);const _t=function(i){return{"single-tab--active":i}};function gt(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"div")(1,"h3",11),t.NdJ("click",function(){const r=t.CHM(o).$implicit;return t.oxw().activeSection=r}),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()}if(2&i){const o=e.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(4,_t,n.activeSection===o)),t.xp6(1),t.hij(" ",t.lcZ(3,2,o)," ")}}function ht(i,e){1&i&&t._UZ(0,"app-logistics-overview")}function ft(i,e){1&i&&t._UZ(0,"app-logistics-streams")}function wt(i,e){1&i&&t._UZ(0,"app-logistics-flows")}let vt=(()=>{class i{constructor(){this.tabs=["overview","streams","flows"],this.activeSection=this.tabs[0]}ngOnInit(){}search(){}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-logistics"]],decls:14,vars:4,consts:[[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"page-title","mt-2","mb-0"],[1,"search-input"],["type","text","nbInput","","placeholder","Search by: Stream, Flow, Workstation"],["nbSuffix","","nbButton","","ghost","",1,"btn","d-flex","align-items-center","justify-content-center",3,"click"],["title","Search","icon","search"],[1,"d-flex","w-100","flex-column","tabs-navigation","mb-4"],[1,"d-flex","pl-3","tabs-container"],[4,"ngFor","ngForOf"],[1,"underline","w-100"],[4,"ngIf"],[1,"single-tab","d-flex","justify-content-center","mb-0",3,"ngClass","click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Logistics"),t.qZA(),t.TgZ(3,"nb-form-field",2),t._UZ(4,"input",3),t.TgZ(5,"button",4),t.NdJ("click",function(){return n.search()}),t._UZ(6,"nb-icon",5),t.qZA()()(),t.TgZ(7,"div",6)(8,"div",7),t.YNc(9,gt,4,6,"div",8),t.qZA(),t._UZ(10,"div",9),t.qZA(),t.YNc(11,ht,1,0,"app-logistics-overview",10),t.YNc(12,ft,1,0,"app-logistics-streams",10),t.YNc(13,wt,1,0,"app-logistics-flows",10)),2&o&&(t.xp6(9),t.Q6J("ngForOf",n.tabs),t.xp6(2),t.Q6J("ngIf","overview"===n.activeSection),t.xp6(1),t.Q6J("ngIf","streams"===n.activeSection),t.xp6(1),t.Q6J("ngIf","flows"===n.activeSection))},directives:[c.jBG,c.h8i,c.DPz,c.yyc,c.fMN,_.sg,_.mk,_.O5,y,h,f],pipes:[_.rS],styles:[".tabs-navigation[_ngcontent-%COMP%]   .tabs-container[_ngcontent-%COMP%]{margin-bottom:-2px;z-index:1}.tabs-navigation[_ngcontent-%COMP%]   .single-tab[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-right:45px;cursor:pointer;-webkit-user-select:none;user-select:none}.tabs-navigation[_ngcontent-%COMP%]   .single-tab--active[_ngcontent-%COMP%]{border-bottom:2px solid white}.underline[_ngcontent-%COMP%]{height:2px;background:#3D536F}.page-title[_ngcontent-%COMP%]{font-size:40px}.search-input[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),i})();var k=g(2268);let bt=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["ng-component"]],decls:2,vars:0,template:function(o,n){1&o&&(t.TgZ(0,"h1"),t._uU(1,"Schedule"),t.qZA())},styles:[""],changeDetection:0}),i})();var Ct=g(9004),St=g(4515);const xt=[{path:"schedule",component:bt},{path:"logistics",component:vt},{path:"",pathMatch:"full",redirectTo:"schedule"},{path:"**",component:Ct.r}];let Tt=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[k.Bz.forChild(xt),St.n],k.Bz]}),i})(),At=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,c.KdK,c.MfT,c.nKr,c.V7y,c.uuI,c.T2N,c.zyh,a.UX,c.rgH,c.x4g,c.YNG,c.IIj]]}),i})(),Ft=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,Tt,At,c.zyh,c.KdK,c.T2N,c.IIj,c.nKr,c.YNG,c.MfT,a.UX]]}),i})()}}]);