"use strict";(self.webpackChunkechelon=self.webpackChunkechelon||[]).push([[938],{8938:(Zt,I,f)=>{f.r(I),f.d(I,{SiteModule:()=>xt});var _=f(9808),l=f(3075),c=f(776),N=f(2601),t=f(5e3);let O=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,c.KdK,l.u5,l.UX,c.IIj,c.nKr,c.zyh,c.T2N,c.uuI,N.r,c.rgH,c.LW9,c.COg]]}),i})();var w=f(655),u=f(4987),A=f(567);let x=(()=>{class i{constructor(e){this.dialog=e,this.completed=new t.vpe,this.title="",this.text=""}cancel(){this.dialog.close()}confirm(){this.completed.emit(!0)}onCloseDialog(){this.cancel()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.X4l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-confirm-popup"]],outputs:{completed:"completed"},decls:15,vars:2,consts:[[1,"spinner-wrapper"],[1,"delete_action"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",2)(4,"h4",3),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",4),t.NdJ("click",function(){return o.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"p"),t._uU(9),t.qZA()(),t.TgZ(10,"div",5)(11,"button",6),t.NdJ("click",function(){return o.cancel()}),t._uU(12,"No"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return o.confirm()}),t._uU(14,"Yes"),t.qZA()()()(),t.BQk()),2&e&&(t.xp6(5),t.Oqu(o.title),t.xp6(4),t.Oqu(o.text))},directives:[c.Asz,c.ndF,c.fMN,c.yKW,c.DPz],styles:[".delete_action[_ngcontent-%COMP%]{min-width:628px;width:628px}.delete_action[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{justify-content:center}.delete_action[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 20px 20px;min-width:140px}"]}),i})();const q=function(i){return{"connectivity-popup__item":!0,active:i}};function F(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().onSelectItem(a)}),t._uU(1),t.qZA()}if(2&i){const e=n.$implicit,o=t.oxw();t.Q6J("ngClass",t.VKq(2,q,null==o.activeItems?null:o.activeItems.includes(e))),t.xp6(1),t.hij(" ",e.displayValue," ")}}function J(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-list-item",9),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().onSelectItem(a)}),t._uU(1),t.qZA()}if(2&i){const e=n.$implicit,o=t.oxw();t.Q6J("ngClass",t.VKq(2,q,null==o.activeItems?null:o.activeItems.includes(e))),t.xp6(1),t.hij(" ",e.displayValue," ")}}const S=function(i){return{"connectivity-popup__button":!0,disabled:i}};let U=(()=>{class i{constructor(e){this.dialog=e,this.completed=new t.vpe,this.title="",this.leftTitle="",this.rightTitle="",this.items=[],this.selectedItems=[],this.activeItems=[]}onSelectItem(e){var o,r;(null===(o=this.activeItems)||void 0===o?void 0:o.includes(e))?this.activeItems=this.activeItems.filter(a=>a!==e):null===(r=this.activeItems)||void 0===r||r.push(e)}onSelectItems(){var e,o;this.items=null===(e=this.items)||void 0===e?void 0:e.filter(r=>{var a;return!(null===(a=this.activeItems)||void 0===a?void 0:a.includes(r))}),null===(o=this.activeItems)||void 0===o||o.forEach(r=>{var a;return null===(a=this.selectedItems)||void 0===a?void 0:a.push(r)}),this.activeItems=[]}onDeselectItems(){var e,o;this.selectedItems=null===(e=this.selectedItems)||void 0===e?void 0:e.filter(r=>{var a;return!(null===(a=this.activeItems)||void 0===a?void 0:a.includes(r))}),null===(o=this.activeItems)||void 0===o||o.forEach(r=>{var a;return null===(a=this.items)||void 0===a?void 0:a.push(r)}),this.activeItems=[]}cancel(){this.dialog.close()}confirm(){this.completed.emit(this.selectedItems)}onCloseDialog(){this.cancel()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.X4l))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-connectivity-popup"]],outputs:{completed:"completed"},decls:29,vars:11,consts:[[1,"connectivity-popup"],[1,""],[1,"modal-title"],["icon","close",1,"close-dialog",3,"click"],[1,"connectivity-popup__inner"],[1,"connectivity-popup__column"],[1,"connectivity-popup__item","connectivity-popup__item-title"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"connectivity-popup__buttons"],[3,"ngClass","click"],[1,"iconEcheclon","icon-arrow-right"],[1,"iconEcheclon","icon-arrow-left"],[1,"modal-footer","modal-footer--no-border"],["nbButton","","outline","","size","medium","type","button",3,"click"],["nbButton","","status","primary","size","medium","type","submit",3,"click"]],template:function(e,o){1&e&&(t.ynx(0),t.TgZ(1,"div",0)(2,"nb-card",1)(3,"nb-card-header",1)(4,"h4",2),t._uU(5),t.qZA(),t.TgZ(6,"nb-icon",3),t.NdJ("click",function(){return o.onCloseDialog()}),t.qZA()(),t.TgZ(7,"nb-card-body")(8,"div",4)(9,"div",5)(10,"nb-list")(11,"nb-list-item",6),t._uU(12),t.qZA(),t.YNc(13,F,2,4,"nb-list-item",7),t.qZA()(),t.TgZ(14,"div",8)(15,"button",9),t.NdJ("click",function(){return o.onSelectItems()}),t._UZ(16,"i",10),t.qZA(),t.TgZ(17,"button",9),t.NdJ("click",function(){return o.onDeselectItems()}),t._UZ(18,"i",11),t.qZA()(),t.TgZ(19,"div",5)(20,"nb-list")(21,"nb-list-item",6),t._uU(22),t.qZA(),t.YNc(23,J,2,4,"nb-list-item",7),t.qZA()()()(),t.TgZ(24,"div",12)(25,"button",13),t.NdJ("click",function(){return o.cancel()}),t._uU(26,"Cancel"),t.qZA(),t.TgZ(27,"button",14),t.NdJ("click",function(){return o.confirm()}),t._uU(28,"Confirm"),t.qZA()()()(),t.BQk()),2&e&&(t.xp6(5),t.Oqu(o.title),t.xp6(7),t.hij(" ",o.leftTitle," "),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(2),t.Q6J("ngClass",t.VKq(7,S,!(null!=o.items&&o.items.length))),t.xp6(2),t.Q6J("ngClass",t.VKq(9,S,!(null!=o.selectedItems&&o.selectedItems.length))),t.xp6(5),t.hij(" ",o.rightTitle," "),t.xp6(1),t.Q6J("ngForOf",o.selectedItems))},directives:[c.Asz,c.ndF,c.fMN,c.yKW,c.zP_,c.qBV,_.sg,_.mk,c.DPz],styles:[".connectivity-popup[_ngcontent-%COMP%]{min-width:900px}.connectivity-popup[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:140px}.connectivity-popup__inner[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.connectivity-popup[_ngcontent-%COMP%]   nb-card[_ngcontent-%COMP%]{width:100%;position:relative}.connectivity-popup__column[_ngcontent-%COMP%]{width:40%;border:1px solid var(--color-primary-600)}.connectivity-popup__item[_ngcontent-%COMP%]{background-color:var(--color-primary-600);margin-bottom:5px;cursor:pointer}.connectivity-popup__item.active[_ngcontent-%COMP%]{background-color:var(--color-primary-800)}.connectivity-popup__item-title[_ngcontent-%COMP%]{background-color:var(--color-primary-500)}.connectivity-popup__buttons[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;justify-content:center;align-items:center}.connectivity-popup__button[_ngcontent-%COMP%]{width:30px;height:30px;font-size:15px;display:flex;justify-content:center;align-items:center;background:var(--color-primary-500);cursor:pointer;border:none;box-shadow:none;margin:5px 0}.connectivity-popup__button.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.connectivity-popup__button[_ngcontent-%COMP%]   .iconEcheclon[_ngcontent-%COMP%]{font-size:15px;height:auto;width:auto}"]}),i})();var h=f(2192);function E(i,n){1&i&&(t.TgZ(0,"span",22),t._uU(1," This field is required "),t.qZA())}function B(i,n){1&i&&(t.TgZ(0,"span",22),t._uU(1," This field is required "),t.qZA())}function D(i,n){if(1&i&&(t.TgZ(0,"nb-option",23),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function Q(i,n){if(1&i&&t._UZ(0,"nb-icon",24),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function Y(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}const P=function(i){return{"table-icon":!0,disabled:i}};function M(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",26),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&i){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,P,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function R(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function G(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",28),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),a=r.$implicit,s=r.index;return t.oxw(2).onDelete(a.uuid,s)}),t.qZA()}}function j(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,E,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,B,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"nb-select",12),t.YNc(9,D,2,2,"nb-option",13),t.qZA()(),t.TgZ(10,"td"),t._UZ(11,"input",14),t.qZA(),t.TgZ(12,"td")(13,"i",15),t.NdJ("click",function(){const r=t.CHM(e),a=r.$implicit,s=r.index;return t.oxw(2).onOpenConnectionPopup(a,s)}),t.qZA()(),t.TgZ(14,"td")(15,"div",16),t.YNc(16,Q,1,1,"nb-icon",17),t.YNc(17,Y,1,0,"nb-icon",18),t.YNc(18,M,1,3,"nb-icon",19),t.YNc(19,R,1,0,"nb-icon",20),t.YNc(20,G,1,0,"nb-icon",21),t.qZA()()()}if(2&i){const e=n.$implicit,o=n.index,r=t.oxw(2);let a,s;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(a=r.getControl(o).get("name"))?null:a.touched)&&(null==(a=r.getControl(o).get("name"))?null:a.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("nameShort"))?null:s.touched)&&(null==(s=r.getControl(o).get("nameShort"))?null:s.getError("required"))),t.xp6(3),t.Q6J("ngForOf",null==r.buffersTypes?null:r.buffersTypes.selectItems),t.xp6(2),t.s9C("value",e.workCenterBuffer?null==e.workCenterBuffer[0]?null:e.workCenterBuffer[0].capacity:0),t.xp6(5),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function H(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Buffer type"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Capacity"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"Connections"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"Actions"),t.qZA(),t.TgZ(15,"th",3)(16,"div",4)(17,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(18,"tbody",6),t.YNc(19,j,21,14,"tr",7),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(18),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.workcenters)}}let g=class{constructor(n,e,o,r,a,s,p,m){this.bufferTypeApi=n,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=a,this.formBuilder=s,this.dialog=p,this.toastrService=m,this.dataAvailable=!1,this.workstations=[],this.workcenters=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new l.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.workcenters].map(n=>{var e,o,r,a,s,p;return this.createWorkcenterGroup(!!n.uuid,null!==(e=n.name)&&void 0!==e?e:"",null!==(o=n.nameShort)&&void 0!==o?o:"",null!==(r=n.uuid)&&void 0!==r?r:"",n.workCenterBuffer?null===(s=null===(a=n.workCenterBuffer[0])||void 0===a?void 0:a.bufferType)||void 0===s?void 0:s.reference:"",n.workCenterBuffer?null===(p=n.workCenterBuffer[0])||void 0===p?void 0:p.capacity:0)}))})}createWorkcenterGroup(n=!0,e="",o="",r="",a="",s=0){return this.formBuilder.group({name:new l.NI({value:e,disabled:n},l.kI.required),nameShort:new l.NI({value:o,disabled:n},l.kI.required),uuid:new l.NI({value:r,disabled:n}),bufferType:new l.NI({value:a,disabled:n}),capacity:new l.NI({value:s,disabled:n})})}onAdd(){this.workcenters.push({name:"",nameShort:""}),this.buildForm(),this.cdr.markForCheck()}onRemove(n){this.workcenters.splice(n,1),this.form.get("formArrayName").removeAt(n),this.cdr.markForCheck()}onOpenConnectionPopup(n,e){var o,r,a;const s=this.dialog.open(U);s.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{s.close()});const p=this.workcenters[e];if(!(null===(o=this.workstations)||void 0===o?void 0:o.length)||!p)return;const m=(null===(r=null==p?void 0:p.workstations)||void 0===r?void 0:r.length)?this.workstations.filter(d=>{var b;return!(null===(b=null==p?void 0:p.workstations)||void 0===b?void 0:b.find(v=>v.reference===d.reference))}):[...this.workstations];s.componentRef.instance.items=m,s.componentRef.instance.selectedItems=null!==(a=null==p?void 0:p.workstations)&&void 0!==a?a:[],s.componentRef.instance.leftTitle="Workstations",s.componentRef.instance.rightTitle=`Workcenter: ${n.name}`,s.componentRef.instance.title="Connect a Workstation to the Workcenter",s.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(d=>{p.workstations=d,s.close(),this.saveEdit(e)})}onDelete(n,e){const o=this.dialog.open(x);o.componentRef.instance.title="Remove workcenter",o.componentRef.instance.text="Are you sure you want to remove this workcenter?",o.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(r=>{n?this.workcenterApi.dataWorkCenterDeleteUuidDelete(n).pipe((0,u.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(n){var e,o;const a=this.form.get("formArrayName").controls[n],p={bufferType:null===(o=null===(e=this.buffersTypes)||void 0===e?void 0:e.selectItems)||void 0===o?void 0:o.find(v=>v.reference===a.value.bufferType),capacity:a.value.capacity},d={name:a.value.name,nameShort:a.value.nameShort,workCenterBuffer:[p],workstations:this.workcenters[n].workstations},b=a.value.uuid;b?this.workcenterApi.dataWorkCenterUpdateUuidPut(b,d).pipe((0,u.t)(this)).subscribe({next:v=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.workcenterApi.dataWorkCenterCreatePost(d).pipe((0,u.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(n)}toggleEdit(n){const e=this.form.get("formArrayName");"DISABLED"===e.controls[n].status?e.controls[n].enable():e.controls[n].disable()}getControl(n){return this.form.get("formArrayName").controls[n]}cancelEdit(n){this.toggleEdit(n);const e=this.form.get("formArrayName"),o=this.workcenters.find(r=>r.uuid===e.controls[n].value.uuid);e.controls[n].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort})}formControlState(n){return this.form.get("formArrayName").controls[n].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,A.D)(this.workstationApi.dataWorkstationAllWorkstationsGet(),this.bufferTypeApi.dataBufferTypeAllBufferTypesGet(),this.workcenterApi.dataWorkCenterListGet()).pipe((0,u.t)(this)).subscribe({next:([n,e,o])=>{this.workcenters=o,this.workstations=n.selectItems,this.buffersTypes=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const n=[];return this.workcenters.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&n.push(e.name)}),n.length?`${n.join(", ")} workcenters has no workstation or buffer connection.`:""}getWarningInfo(n){const e=null==n?void 0:n.map(o=>o.displayValue).join(". ");return null!=e?e:""}showToast(n,e,o,r=5e3,a=""){!o||this.toastrService.show(e||"Success",o,{icon:a,position:n,status:e,duration:r,destroyByClick:!0,limit:1})}};function V(i,n){1&i&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function $(i,n){1&i&&(t.TgZ(0,"span",24),t._uU(1," This field is required "),t.qZA())}function z(i,n){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function K(i,n){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function X(i,n){if(1&i&&(t.TgZ(0,"nb-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.s9C("value",e.reference),t.xp6(1),t.Oqu(e.displayValue)}}function L(i,n){if(1&i&&t._UZ(0,"nb-icon",26),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function tt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}g.\u0275fac=function(n){return new(n||g)(t.Y36(h.jg),t.Y36(h.F),t.Y36(h.Uv),t.Y36(h.B0),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(c.Gln),t.Y36(c.quB))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-workcenter-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["fullWidth","","status","control","placeholder","Buffer type","formControlName","bufferType",1,"select","editable-input"],[3,"value",4,"ngFor","ngForOf"],["status","primary","nbInput","","type","number","formControlName","capacity",1,"editable-input",3,"value"],[1,"iconEcheclon","icon-connection",3,"click"],[1,"float-right","icons-wrapper"],["nbTooltipStatus","primary","class","warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],[3,"value"],["nbTooltipStatus","primary","icon","warning",1,"warning-icon",3,"nbTooltip"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,H,20,3,"table",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,_.O5,l.JL,l.sg,c.fMN,l.CE,_.sg,l.x0,c.h8i,l.Fj,l.JJ,l.u,c.rs,c.q51,l.wV,c.jNv,_.mk],styles:[""],changeDetection:0}),g=(0,w.gn)([(0,u.c)()],g);const et=function(i){return{"table-icon":!0,disabled:i}};function nt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",28),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&i){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,et,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function ot(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",29),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function it(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",30),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),a=r.$implicit,s=r.index;return t.oxw(2).onDelete(a.uuid,s)}),t.qZA()}}function rt(i,n){if(1&i&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,V,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,$,2,0,"span",10),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"input",12),t.qZA(),t.TgZ(9,"td")(10,"nb-select",13),t.YNc(11,z,2,2,"nb-option",14),t.qZA()(),t.TgZ(12,"td"),t._UZ(13,"input",15),t.qZA(),t.TgZ(14,"td")(15,"nb-select",16),t.YNc(16,K,2,2,"nb-option",14),t.qZA()(),t.TgZ(17,"td")(18,"nb-select",17),t.YNc(19,X,2,2,"nb-option",14),t.qZA()(),t.TgZ(20,"td")(21,"div",18),t.YNc(22,L,1,1,"nb-icon",19),t.YNc(23,tt,1,0,"nb-icon",20),t.YNc(24,nt,1,3,"nb-icon",21),t.YNc(25,ot,1,0,"nb-icon",22),t.YNc(26,it,1,0,"nb-icon",23),t.qZA()()()),2&i){const e=n.$implicit,o=n.index,r=t.oxw(2);let a,s;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(a=r.getControl(o).get("name"))?null:a.touched)&&(null==(a=r.getControl(o).get("name"))?null:a.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("nameShort"))?null:s.touched)&&(null==(s=r.getControl(o).get("nameShort"))?null:s.getError("required"))),t.xp6(2),t.s9C("id",e.amountOfWorkstations),t.s9C("value",e.amountOfWorkstations),t.xp6(3),t.Q6J("ngForOf",null==r.buffersTypes?null:r.buffersTypes.selectItems),t.xp6(2),t.s9C("value",e.workStationBuffers?null==e.workStationBuffers[0]?null:e.workStationBuffers[0].capacity:0),t.xp6(3),t.Q6J("ngForOf",r.activities),t.xp6(3),t.Q6J("ngForOf",r.workcenters),t.xp6(3),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(1),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function at(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Amount of workstations"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Buffer type"),t.qZA(),t.TgZ(11,"th",3),t._uU(12,"Capacity"),t.qZA(),t.TgZ(13,"th",3),t._uU(14,"Activity"),t.qZA(),t.TgZ(15,"th",3),t._uU(16,"Workcenter"),t.qZA(),t.TgZ(17,"th",3)(18,"div",4)(19,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(20,"tbody",6),t.YNc(21,rt,27,18,"tr",7),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(20),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.workstations)}}let T=class{constructor(n,e,o,r,a,s,p,m){this.bufferTypeApi=n,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=a,this.formBuilder=s,this.dialog=p,this.toastrService=m,this.dataAvailable=!1,this.workstations=[],this.workcenters=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new l.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.workstations].map(n=>{var e,o,r,a,s,p,m,d,b,v,Z;return this.createWorkstationGroup(!!n.uuid,null!==(e=n.name)&&void 0!==e?e:"",null!==(o=n.nameShort)&&void 0!==o?o:"",null!==(r=n.amountOfWorkstations)&&void 0!==r?r:0,null!==(a=n.uuid)&&void 0!==a?a:"",null!==(p=null===(s=n.activity)||void 0===s?void 0:s.reference)&&void 0!==p?p:"",null!==(d=null===(m=n.workCenter)||void 0===m?void 0:m.reference)&&void 0!==d?d:"",n.workStationBuffers?null===(v=null===(b=n.workStationBuffers[0])||void 0===b?void 0:b.bufferType)||void 0===v?void 0:v.reference:"",n.workStationBuffers?null===(Z=n.workStationBuffers[0])||void 0===Z?void 0:Z.capacity:0)}))})}createWorkstationGroup(n=!0,e="",o="",r=0,a="",s="",p="",m="",d=0){return this.formBuilder.group({name:new l.NI({value:e,disabled:n},l.kI.required),nameShort:new l.NI({value:o,disabled:n},l.kI.required),amountOfWorkstations:new l.NI({value:r,disabled:n}),uuid:new l.NI({value:a,disabled:n}),activity:new l.NI({value:s,disabled:n}),workcenter:new l.NI({value:p,disabled:n}),bufferType:new l.NI({value:m,disabled:n}),capacity:new l.NI({value:d,disabled:n})})}onAdd(){this.workstations.push({name:"",nameShort:"",amountOfWorkstations:0,activity:{},workCenter:{}}),this.buildForm(),this.cdr.markForCheck()}onRemove(n){this.workstations.splice(n,1),this.form.get("formArrayName").removeAt(n),this.cdr.markForCheck()}onDelete(n,e){const o=this.dialog.open(x);o.componentRef.instance.title="Remove workstation",o.componentRef.instance.text="Are you sure you want to remove this workstation?",o.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(r=>{n?this.workstationApi.dataWorkstationDeleteUuidDelete(n).pipe((0,u.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(n){var e,o;const a=this.form.get("formArrayName").controls[n],p={bufferType:null===(o=null===(e=this.buffersTypes)||void 0===e?void 0:e.selectItems)||void 0===o?void 0:o.find(b=>b.reference===a.value.bufferType),capacity:a.value.capacity},m={name:a.value.name,nameShort:a.value.nameShort,amountOfWorkstations:a.value.amountOfWorkstations,workStationBuffers:[p],activity:this.getSelectedActivityObject(a.value.activity),workCenter:this.getSelectedWorkcenterObject(a.value.workcenter)},d=a.value.uuid;d?this.workstationApi.dataWorkstationUpdateUuidPut(d,m).pipe((0,u.t)(this)).subscribe({next:b=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.workstationApi.dataWorkstationCreatePost(m).pipe((0,u.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(n)}toggleEdit(n){const e=this.form.get("formArrayName");"DISABLED"===e.controls[n].status?e.controls[n].enable():e.controls[n].disable()}getControl(n){return this.form.get("formArrayName").controls[n]}cancelEdit(n){this.toggleEdit(n);const e=this.form.get("formArrayName"),o=this.workstations.find(r=>r.uuid===e.controls[n].value.uuid);e.controls[n].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort,amountOfWorkstations:null==o?void 0:o.amountOfWorkstations})}formControlState(n){return this.form.get("formArrayName").controls[n].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,A.D)(this.workstationApi.dataWorkstationListGet(),this.bufferTypeApi.dataBufferTypeAllBufferTypesGet(),this.activityApi.dataActivityAllActivitiesGet(),this.workcenterApi.dataWorkCenterAllWorkCentersGet()).pipe((0,u.t)(this)).subscribe({next:([n,e,o,r])=>{this.workcenters=r.selectItems,this.workstations=n,this.activities=o.selectItems,this.buffersTypes=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const n=[];return this.workstations.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&n.push(e.name)}),n.length?`${n.join(", ")} workstations has no activity connection or workcenter connection or buffer connection.`:""}getWarningInfo(n){const e=null==n?void 0:n.map(o=>o.displayValue).join(". ");return null!=e?e:""}getSelectedActivityObject(n){var e;return(null===(e=this.activities)||void 0===e?void 0:e.filter(r=>r.reference===n)[0])||{}}getSelectedWorkcenterObject(n){var e;return(null===(e=this.workcenters)||void 0===e?void 0:e.filter(r=>r.reference===n)[0])||{}}showToast(n,e,o,r=5e3,a=""){!o||this.toastrService.show(e||"Success",o,{icon:a,position:n,status:e,duration:r,destroyByClick:!0,limit:1})}};function ct(i,n){1&i&&(t.TgZ(0,"span",18),t._uU(1," This field is required "),t.qZA())}function st(i,n){1&i&&(t.TgZ(0,"span",18),t._uU(1," This field is required "),t.qZA())}function lt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).toggleEdit(r)}),t.qZA()}}T.\u0275fac=function(n){return new(n||T)(t.Y36(h.jg),t.Y36(h.F),t.Y36(h.Uv),t.Y36(h.B0),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(c.Gln),t.Y36(c.quB))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-workstation-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["status","primary","nbInput","","type","number","formControlName","amountOfWorkstations",1,"editable-input",3,"id","value"],["fullWidth","","status","control","placeholder","Buffer type","formControlName","bufferType",1,"select","editable-input"],[3,"value",4,"ngFor","ngForOf"],["status","primary","nbInput","","type","number","formControlName","capacity",1,"editable-input",3,"value"],["fullWidth","","status","control","placeholder","Activity","formControlName","activity",1,"select","editable-input"],["fullWidth","","status","control","placeholder","Workcenter","formControlName","workcenter",1,"select","editable-input"],[1,"float-right","icons-wrapper"],["nbTooltipStatus","primary","class","warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],[3,"value"],["nbTooltipStatus","primary","icon","warning",1,"warning-icon",3,"nbTooltip"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,at,22,3,"table",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,_.O5,l.JL,l.sg,c.fMN,l.CE,_.sg,l.x0,c.h8i,l.Fj,l.JJ,l.u,l.wV,c.rs,c.q51,c.jNv,_.mk],styles:[""],changeDetection:0}),T=(0,w.gn)([(0,u.c)()],T);const pt=function(i){return{"table-icon":!0,disabled:i}};function ut(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).saveEdit(r)}),t.qZA()}if(2&i){const e=t.oxw().index,o=t.oxw(2);let r;t.Q6J("ngClass",t.VKq(1,pt,null==(r=o.getControl(e).get("name"))?null:r.getError("required")))}}function mt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().index;return t.oxw(2).cancelEdit(r)}),t.qZA()}}function _t(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"nb-icon",22),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),a=r.$implicit,s=r.index;return t.oxw(2).onDelete(a.uuid,s)}),t.qZA()}}function dt(i,n){if(1&i&&(t.TgZ(0,"tr",8)(1,"td"),t._UZ(2,"input",9),t.YNc(3,ct,2,0,"span",10),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",11),t.YNc(6,st,2,0,"span",10),t.qZA(),t.TgZ(7,"td")(8,"textarea",12),t._uU(9,"            "),t.qZA()(),t.TgZ(10,"td")(11,"div",13),t.YNc(12,lt,1,0,"nb-icon",14),t.YNc(13,ut,1,3,"nb-icon",15),t.YNc(14,mt,1,0,"nb-icon",16),t.YNc(15,_t,1,0,"nb-icon",17),t.qZA()()()),2&i){const e=n.$implicit,o=n.index,r=t.oxw(2);let a,s;t.Q6J("formGroupName",o),t.xp6(2),t.s9C("id",e.name),t.s9C("value",e.name),t.xp6(1),t.Q6J("ngIf",(null==(a=r.getControl(o).get("name"))?null:a.touched)&&(null==(a=r.getControl(o).get("name"))?null:a.getError("required"))),t.xp6(2),t.s9C("id",e.nameShort),t.s9C("value",e.nameShort),t.xp6(1),t.Q6J("ngIf",(null==(s=r.getControl(o).get("nameShort"))?null:s.touched)&&(null==(s=r.getControl(o).get("nameShort"))?null:s.getError("required"))),t.xp6(2),t.s9C("id",e.description),t.s9C("value",e.description),t.xp6(4),t.Q6J("ngIf",r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",!r.formControlState(o)),t.xp6(1),t.Q6J("ngIf",r.formControlState(o))}}function ft(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"table",2)(1,"thead")(2,"tr")(3,"th",3),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",3),t._uU(6,"Name Short"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Description"),t.qZA(),t.TgZ(9,"th",3)(10,"div",4)(11,"nb-icon",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onAdd()}),t.qZA()()()()(),t.TgZ(12,"tbody",6),t.YNc(13,dt,16,13,"tr",7),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(12),t.Q6J("formArrayName","formArrayName"),t.xp6(1),t.Q6J("ngForOf",e.activities)}}let y=class{constructor(n,e,o,r,a,s,p,m){this.bufferTypeApi=n,this.workstationApi=e,this.workcenterApi=o,this.activityApi=r,this.cdr=a,this.formBuilder=s,this.dialog=p,this.toastrService=m,this.dataAvailable=!1,this.workstations=[],this.activities=[],this.editable=!1,this.positions=c.fe3,this.reloadData="",this.editItem=new t.vpe,this.removeItem=new t.vpe,this.addNewItem=new t.vpe,this.form=new l.cw({formArrayName:this.formBuilder.array([])})}ngOnInit(){this.findData()}getBuffersType(){}buildForm(){this.form=this.formBuilder.group({formArrayName:this.formBuilder.array([...this.activities].map(n=>{var e,o,r,a;return this.createActivityGroup(!!n.uuid,null!==(e=n.name)&&void 0!==e?e:"",null!==(o=n.nameShort)&&void 0!==o?o:"",null!==(r=n.description)&&void 0!==r?r:"",null!==(a=n.uuid)&&void 0!==a?a:"")}))})}createActivityGroup(n=!0,e="",o="",r="",a=""){return this.formBuilder.group({name:new l.NI({value:e,disabled:n},l.kI.required),nameShort:new l.NI({value:o,disabled:n},l.kI.required),description:new l.NI({value:r,disabled:n}),uuid:new l.NI({value:a,disabled:n})})}onAdd(){this.activities.push({name:"",nameShort:"",description:""}),this.buildForm(),this.cdr.markForCheck()}onRemove(n){this.activities.splice(n,1),this.form.get("formArrayName").removeAt(n),this.cdr.markForCheck()}onDelete(n,e){const o=this.dialog.open(x);o.componentRef.instance.title="Remove activity",o.componentRef.instance.text="Are you sure you want to remove this activity?",o.onBackdropClick.pipe((0,u.t)(this)).subscribe(()=>{o.close()}),o.componentRef.instance.completed.pipe((0,u.t)(this)).subscribe(r=>{n?this.activityApi.dataActivityDeleteUuidDelete(n).pipe((0,u.t)(this)).subscribe({next:()=>{this.onRemove(e),this.cdr.markForCheck(),o.close()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):(this.onRemove(e),o.close())})}saveEdit(n){const o=this.form.get("formArrayName").controls[n],r={name:o.value.name,nameShort:o.value.nameShort,description:o.value.description},a=o.value.uuid;a?this.activityApi.dataActivityUpdateUuidPut(a,r).pipe((0,u.t)(this)).subscribe({next:s=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}):this.activityApi.dataActivityCreatePost(r).pipe((0,u.t)(this)).subscribe({next:()=>{this.findData()},error:()=>{this.showToast(this.positions.TOP_RIGHT,"danger","Something went wrong, please try again later.",3e3)}}),this.toggleEdit(n)}toggleEdit(n){const e=this.form.get("formArrayName");"DISABLED"===e.controls[n].status?e.controls[n].enable():e.controls[n].disable()}getControl(n){return this.form.get("formArrayName").controls[n]}cancelEdit(n){this.toggleEdit(n);const e=this.form.get("formArrayName"),o=this.activities.find(r=>r.uuid===e.controls[n].value.uuid);e.controls[n].patchValue({name:null==o?void 0:o.name,nameShort:null==o?void 0:o.nameShort,description:null==o?void 0:o.description})}formControlState(n){return this.form.get("formArrayName").controls[n].disabled}getControlsArray(){return this.form.get("formArrayName")}findData(){(0,A.D)(this.workstationApi.dataWorkstationAllWorkstationsGet(),this.activityApi.dataActivityListGet()).pipe((0,u.t)(this)).subscribe({next:([n,e])=>{this.workstations=n.selectItems,this.activities=e,this.dataAvailable=!0,this.buildForm(),this.cdr.markForCheck(),this.showToast(this.positions.TOP_RIGHT,"danger",this.createToastMessage())}})}createToastMessage(){const n=[];return this.activities.forEach(e=>{var o;(null===(o=null==e?void 0:e.missingLinks)||void 0===o?void 0:o.length)&&n.push(e.name)}),n.length?`${n.join(", ")} activities has no workstation connection.`:""}getWarningInfo(n){const e=null==n?void 0:n.map(o=>o.displayValue).join(". ");return null!=e?e:""}showToast(n,e,o,r=5e3,a=""){!o||this.toastrService.show(e||"Success",o,{icon:a,position:n,status:e,duration:r,destroyByClick:!0,limit:1})}};y.\u0275fac=function(n){return new(n||y)(t.Y36(h.jg),t.Y36(h.F),t.Y36(h.Uv),t.Y36(h.B0),t.Y36(t.sBO),t.Y36(l.qu),t.Y36(c.Gln),t.Y36(c.quB))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-activity-table"]],inputs:{reloadData:"reloadData"},outputs:{editItem:"editItem",removeItem:"removeItem",addNewItem:"addNewItem"},decls:3,vars:2,consts:[[1,"spinner-wrapper","overflow-auto",3,"nbSpinner"],["class","table",3,"formGroup",4,"ngIf"],[1,"table",3,"formGroup"],["scope","col"],[1,"float-right"],["title","Create","icon","add_circle",1,"table-icon",3,"click"],[3,"formArrayName"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["status","primary","nbInput","","type","text","formControlName","name",1,"editable-input",3,"id","value"],["class","text-danger",4,"ngIf"],["status","primary","nbInput","","type","text","formControlName","nameShort",1,"editable-input",3,"id","value"],["status","primary","nbInput","","type","text","formControlName","description",1,"editable-input",3,"id","value"],[1,"float-right","icons-wrapper"],["class","table-icon","title","Edit","icon","edit",3,"click",4,"ngIf"],["class","table-icon","title","Edit","icon","check_circle","type","button",3,"ngClass","click",4,"ngIf"],["class","table-icon","title","Delete","icon","close",3,"click",4,"ngIf"],["class","table-icon","title","Delete","icon","delete",3,"click",4,"ngIf"],[1,"text-danger"],["title","Edit","icon","edit",1,"table-icon",3,"click"],["title","Edit","icon","check_circle","type","button",1,"table-icon",3,"ngClass","click"],["title","Delete","icon","close",1,"table-icon",3,"click"],["title","Delete","icon","delete",1,"table-icon",3,"click"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,ft,14,3,"table",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvailable),t.xp6(1),t.Q6J("ngIf",e.dataAvailable))},directives:[c.Q7R,_.O5,l.JL,l.sg,c.fMN,l.CE,_.sg,l.x0,c.h8i,l.Fj,l.JJ,l.u,_.mk],styles:[""],changeDetection:0}),y=(0,w.gn)([(0,u.c)()],y);let k=class{};k.\u0275fac=function(n){return new(n||k)},k.\u0275cmp=t.Xpm({type:k,selectors:[["app-flow-table"]],decls:2,vars:0,template:function(n,e){1&n&&(t.TgZ(0,"p"),t._uU(1,"Flow table is not implkemented"),t.qZA())},styles:[""]}),k=(0,w.gn)([(0,u.c)()],k);var W=f(2268),ht=f(9004),bt=f(4515);let vt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-activities"]],decls:6,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Activities"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4," Define and describe activities. An activity can be linked to a workstation to help planning and have a better understanding of the work (the activity) that is execuited by the workforce on a specific workstation.\n"),t.qZA(),t._UZ(5,"app-activity-table"))},directives:[y],styles:[""],changeDetection:0}),i})(),gt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flows"]],decls:3,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"flows"),t.qZA(),t._UZ(2,"app-flow-table"))},directives:[k],styles:[""]}),i})();function Tt(i,n){if(1&i&&t._UZ(0,"nb-icon",14),2&i){const e=t.oxw().$implicit,o=t.oxw(3);t.Q6J("nbTooltip",o.getWarningInfo(e.missingLinks))}}function yt(i,n){if(1&i&&(t.TgZ(0,"div")(1,"div",6),t.YNc(2,Tt,1,1,"nb-icon",7),t.TgZ(3,"div",8),t._UZ(4,"img",9),t.qZA(),t.TgZ(5,"div",10)(6,"div",11)(7,"p",12),t._uU(8,"Workstation:"),t.qZA(),t.TgZ(9,"p",13),t._uU(10),t.qZA()(),t.TgZ(11,"div",11)(12,"p",12),t._uU(13,"Activity:"),t.qZA(),t.TgZ(14,"p",13),t._uU(15),t.qZA()(),t.TgZ(16,"div",11)(17,"p",12),t._uU(18,"Short:"),t.qZA(),t.TgZ(19,"p",13),t._uU(20),t.qZA()()()()()),2&i){const e=n.$implicit;t.xp6(2),t.Q6J("ngIf","Warning"===e.linkStatus||"Critical"===e.linkStatus),t.xp6(8),t.Oqu(e.displayValue),t.xp6(5),t.Oqu(e.activity.displayValue),t.xp6(5),t.Oqu(e.code)}}function kt(i,n){if(1&i&&(t.TgZ(0,"div",3)(1,"h2",3),t._uU(2),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,yt,21,4,"div",5),t.qZA()()),2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",e.workstations)}}function Ct(i,n){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,kt,5,2,"div",2),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.dataTree)}}let C=class{constructor(n,e,o){this.cdr=n,this.workcenterApi=e,this.workstationApi=o,this.workcenters=[],this.workstations=[],this.dataAvalaible=!1,this.dataTree=[]}ngOnInit(){this.getData()}getData(){(0,A.D)(this.workcenterApi.dataWorkCenterListGet(),this.workstationApi.dataWorkstationListGet()).pipe((0,u.t)(this)).subscribe({next:([n,e])=>{this.workcenters=n,this.workstations=e,this.dataAvalaible=!0,this.buildDataTree(),this.cdr.markForCheck()}})}buildDataTree(){const n=[...this.workcenters].map(e=>{var o;return null===(o=e.workstations)||void 0===o||o.forEach((r,a)=>{const s=r.reference,p=this.workstations.find(m=>m.uuid===s);e.workstations[a]=Object.assign(Object.assign({},e.workstations[a]),p)}),e});this.dataTree=n}getWarningInfo(n){return n.map(o=>o.displayValue).join(". ")}};C.\u0275fac=function(n){return new(n||C)(t.Y36(t.sBO),t.Y36(h.Uv),t.Y36(h.F))},C.\u0275cmp=t.Xpm({type:C,selectors:[["app-overview"]],decls:3,vars:2,consts:[[3,"nbSpinner"],[4,"ngIf"],["class","mb-3",4,"ngFor","ngForOf"],[1,"mb-3"],[1,"row"],[4,"ngFor","ngForOf"],[1,"item-card"],["nbTooltipStatus","primary","class","item-card__warning warning-icon","icon","warning",3,"nbTooltip",4,"ngIf"],[1,"item-card__image-wrapper"],["src","assets/images/packing.jpg","alt",""],[1,"item-card__content"],[1,"item-card__text"],[1,"item-card__label"],[1,"item-card__value"],["nbTooltipStatus","primary","icon","warning",1,"item-card__warning","warning-icon",3,"nbTooltip"]],template:function(n,e){1&n&&(t.ynx(0),t.TgZ(1,"div",0),t.YNc(2,Ct,2,1,"div",1),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("nbSpinner",!e.dataAvalaible),t.xp6(1),t.Q6J("ngIf",e.dataAvalaible))},directives:[c.Q7R,_.O5,_.sg,c.fMN,c.jNv],styles:[""]}),C=(0,w.gn)([(0,u.c)()],C);const wt=[{path:"overview",component:C},{path:"activity",component:vt},{path:"workcenter",component:(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-workcenters"]],decls:6,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Workcenters"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4," View and define your work centers here. A work center can contain zero or more workstations. These workstations can be linked to the work center in the details view.\n"),t.qZA(),t._UZ(5,"app-workcenter-table"))},directives:[g],styles:[""],changeDetection:0}),i})()},{path:"workstation",component:(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-workstations"]],decls:6,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"Workstations"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4,"View and define your work stations here."),t.qZA(),t._UZ(5,"app-workstation-table"))},directives:[T],styles:[""],changeDetection:0}),i})()},{path:"flow",component:gt},{path:"",pathMatch:"full",redirectTo:"overview"},{path:"**",component:ht.r}];let At=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[W.Bz.forChild(wt),bt.n],W.Bz]}),i})(),xt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,l.u5,l.UX,At,c.T2N,c.zyh,c.KdK,c._WB,c.IIj,c.EoG,O,c.uuI,c.rgH,N.r,c.nKr,c.COg]]}),i})()}}]);