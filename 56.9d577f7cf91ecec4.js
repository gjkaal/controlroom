"use strict";(self.webpackChunkechelon=self.webpackChunkechelon||[]).push([[56],{592:(j,g,i)=>{i.r(g),i.d(g,{SettingsPermissionsModule:()=>B});var d=i(9808),p=i(6798),Z=i(655),_=i(4987),C=i(591),h=i(2994),v=i(7545),b=i(2014),t=i(5e3),f=i(1333),l=i(9697);function A(n,o){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"nb-icon",9)(7,"nb-icon",10),t.qZA()()),2&n){const e=o.$implicit;t.xp6(2),t.AsE("",e.firstName," ",e.surname,""),t.xp6(2),t.Oqu(e.emailAddress)}}function x(n,o){if(1&n&&(t.TgZ(0,"table",5)(1,"thead")(2,"tr")(3,"th",6),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"th",6),t._uU(6,"E-mail"),t.qZA(),t.TgZ(7,"th",6),t._UZ(8,"nb-icon",7),t.qZA()()(),t.TgZ(9,"tbody"),t.YNc(10,A,8,3,"tr",8),t.qZA()()),2&n){const e=t.oxw().ngIf;t.xp6(10),t.Q6J("ngForOf",null==e?null:e.items)}}function T(n,o){1&n&&(t.TgZ(0,"p"),t._uU(1,"There are no users to display."),t.qZA())}function U(n,o){if(1&n&&(t.ynx(0),t.YNc(1,x,11,1,"table",3),t.YNc(2,T,2,0,"ng-template",null,4,t.W1O),t.BQk()),2&n){const e=o.ngIf,s=t.MAs(3);t.xp6(1),t.Q6J("ngIf",null==e||null==e.items?null:e.items.length)("ngIfElse",s)}}function y(n,o){1&n&&t._UZ(0,"div",11),2&n&&t.Q6J("nbSpinner",!0)}let m=class{constructor(o){this.userApi=o,this.currentDataPage=1,this.maxPages=1,this.isLoading=!1,this.updateChange=new C.X({}),this.message=""}ngOnInit(){this.getUserList()}getUserList(){this.usersLists$=this.updateChange.asObservable().pipe((0,h.b)(o=>this.action=o),(0,v.w)(()=>this.userApi.dataUserListGet(void 0,void 0,this.currentDataPage.toString())),(0,h.b)(o=>{this.maxPages=o.totalPages}),(0,b.R)((o,e)=>{var s,a;"nextPage"===this.action.action&&(null===(s=o.items)||void 0===s||s.push(...e.items));let c=o.items;return c=null===(a=o.items)||void 0===a?void 0:a.filter((u,q,$)=>q===$.findIndex(z=>z.uuid===u.uuid)),o}))}checkIfScrolledToBottom(){const o=document.getElementById("table-list");(null==o?void 0:o.scrollTop)-((null==o?void 0:o.scrollHeight)-(null==o?void 0:o.clientHeight))>-20&&this.maxPages>this.currentDataPage&&(this.currentDataPage++,this.updateChange.next({action:"nextPage"}))}};m.\u0275fac=function(o){return new(o||m)(t.Y36(f.Wj))},m.\u0275cmp=t.Xpm({type:m,selectors:[["ng-component"]],decls:8,vars:4,consts:[[1,"table-container","table-fixed-header"],[4,"ngIf","ngIfElse"],["loading",""],["class","table",4,"ngIf","ngIfElse"],["noUsers",""],[1,"table"],["scope","col"],["title","Edit","icon","add_circle"],[4,"ngFor","ngForOf"],["title","Edit","icon","edit"],["title","Delete","icon","close"],[3,"nbSpinner"]],template:function(o,e){if(1&o&&(t.TgZ(0,"h1"),t._uU(1,"Users"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"div",0),t.YNc(4,U,4,2,"ng-container",1),t.ALo(5,"async"),t.qZA(),t.YNc(6,y,1,1,"ng-template",null,2,t.W1O)),2&o){const s=t.MAs(7);t.xp6(4),t.Q6J("ngIf",t.lcZ(5,2,e.usersLists$))("ngIfElse",s)}},directives:[d.O5,l.fMN,d.sg,l.Q7R],pipes:[d.Ov],styles:[".table-container[_ngcontent-%COMP%]{max-height:60vh;overflow:scroll}"],changeDetection:0}),m=(0,Z.gn)([(0,_.c)()],m);var N=i(9004),r=i(3075),R=i(8929),I=i(7625),S=i(7253);const F=["edit_dialog"];function P(n,o){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"nb-icon",6)(5,"nb-icon",7),t.qZA()()),2&n){const e=o.$implicit;t.xp6(2),t.Oqu(e.displayValue)}}function M(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"table",2)(2,"thead")(3,"tr")(4,"th",3),t._uU(5,"Role name"),t.qZA(),t.TgZ(6,"th",3)(7,"nb-icon",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().addNew()}),t.qZA()()()(),t.TgZ(8,"tbody"),t.YNc(9,P,6,1,"tr",5),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(9),t.Q6J("ngForOf",e.items)}}function O(n,o){1&n&&t._uU(0,"Loading data...")}function w(n,o){1&n&&t.YNc(0,O,1,0,"ng-template")}function E(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"nb-card")(1,"nb-card-header")(2,"h1"),t._uU(3),t.qZA()(),t.TgZ(4,"nb-card-body")(5,"form",8)(6,"div",9)(7,"label",10),t._uU(8,"Name"),t.qZA(),t.TgZ(9,"div",11),t._UZ(10,"input",12),t.qZA()(),t.TgZ(11,"div",13)(12,"label",14),t._uU(13,"Short name"),t.qZA(),t.TgZ(14,"div",15),t._UZ(15,"input",16),t.qZA()()()(),t.TgZ(16,"nb-card-footer")(17,"div",17)(18,"button",18),t.NdJ("click",function(){const c=t.CHM(e).dialogRef,u=t.oxw();return c.close(u.addNewComplete(!1))}),t._uU(19,"Cancel"),t.qZA(),t.TgZ(20,"button",19),t.NdJ("click",function(){const c=t.CHM(e).dialogRef,u=t.oxw();return c.close(u.addNewComplete(!0))}),t._uU(21,"Save changes"),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(3),t.Oqu(e.editLabel),t.xp6(2),t.Q6J("formGroup",e.addNewForm)}}let J=(()=>{class n{constructor(e,s,a,c){this.api=e,this.cdr=s,this.dialogService=a,this.toast=c,this.destroy$=new R.xQ,this.addNewForm=new r.cw({name:new r.NI,nameShort:new r.NI}),this.message="",this.items=[],this.loading=!1,this.dataAvailable=!1,this.editLabel="Edit"}loadData(){return!!(this.items&&this.items.length>0)||(this.loading=!0,this.api.dataRoleActiveSiteRolesGet().subscribe({next:e=>{e.selectItems?this.items=e.selectItems:this.message=`${e.message}`,this.loading=!1,this.dataAvailable=!0,this.cdr.markForCheck()},error:e=>{this.loading=!1,this.message=e,this.cdr.markForCheck()}}),!1)}formControls(e){return this.addNewForm.controls}addNew(){this.editLabel="Add role",this.dialogService.open(this.editItem).onClose.pipe((0,I.R)(this.destroy$)).subscribe(e=>{!e||this.toast.notifyAboutChange(e)})}addNewComplete(e){if(!e)return"Aborted";const s=this.formControls(this.addNewForm);return this.api.dataRoleCreatePost({name:s.name.value,nameShort:s.nameShort.value}).subscribe(c=>{this.toast.notifyAboutChange(`${c}`),this.items=[],this.cdr.markForCheck()}),"Creating new role."}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.Ah),t.Y36(t.sBO),t.Y36(l.Gln),t.Y36(S.ez))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,s){if(1&e&&t.Gf(F,5),2&e){let a;t.iGM(a=t.CRH())&&(s.editItem=a.first)}},decls:7,vars:2,consts:[[4,"ngIf"],["edit_dialog",""],[1,"table"],["scope","col"],["title","Add","icon","add_circle",1,"table-icon",3,"click"],[4,"ngFor","ngForOf"],["title","Edit","icon","edit",1,"table-icon"],["title","Delete","icon","close",1,"table-icon"],[3,"formGroup"],[1,"row","mb-10"],["for","name",1,"col-sm-2"],[1,"col-sm-1"],["id","name","formControlName","name"],[1,"row","mb-3"],["for","nameShort",1,"col-sm-2"],[1,"col-sm-10"],["id","nameShort","formControlName","nameShort"],[1,"d-flex","align-items-center","justify-content-center"],["nbButton","","outline","","size","medium",1,"mr-3",3,"click"],["nbButton","","status","primary","size","medium",3,"click"]],template:function(e,s){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Roles"),t.qZA(),t._UZ(2,"hr"),t.YNc(3,M,10,1,"ng-container",0),t.YNc(4,w,1,0,null,0),t.YNc(5,E,22,2,"ng-template",null,1,t.W1O)),2&e&&(t.xp6(3),t.Q6J("ngIf",s.dataAvailable),t.xp6(1),t.Q6J("ngIf",s.loading))},directives:[d.O5,l.fMN,d.sg,l.Asz,l.ndF,l.yKW,r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,l.XWE,l.DPz],styles:[""],changeDetection:0}),n})(),Y=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:5,vars:0,template:function(e,s){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Access"),t.qZA(),t._UZ(2,"hr"),t.TgZ(3,"p"),t._uU(4,"Use this page to assign menu access rights to roles."),t.qZA())},styles:[""],changeDetection:0}),n})();var D=i(4515);const L=[{path:"user",component:m},{path:"roles",component:J},{path:"access",component:Y},{path:"",pathMatch:"full",redirectTo:"user"},{path:"**",component:N.r}];let Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.Bz.forChild(L),D.n],p.Bz]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.ez,Q,r.u5,r.UX,l.T2N,l.zyh,l.KdK,l._WB,l.IIj,l.EoG,l.uuI]]}),n})()}}]);